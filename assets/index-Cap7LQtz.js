import{r as p,j as e,R as Mt}from"./react-BhuEaPR1.js";import{c as It}from"./react-dom-CexaR4xk.js";import{u as be,a as $e,b as Et,L as Dt,N as Ft,B as Bt,R as wt,c as ue}from"./react-router-CexyVg5r.js";import{m as he}from"./framer-motion-B8DewuuU.js";import{E as ht}from"./exceljs-CiTfLnB0.js";import"./cookie-Cpj98o6Y.js";import"./scheduler-Bb8JjhAW.js";import"./motion-dom-DMoQULKC.js";import"./motion-utils-CjIqCkNq.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const n of l.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&s(n)}).observe(document,{childList:!0,subtree:!0});function a(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(i){if(i.ep)return;i.ep=!0;const l=a(i);fetch(i.href,l)}})();function kt({open:t,onClose:r,initial:a={},onSave:s}){const i={reportingPeriod:a.reportingPeriod||"002.2025",inflation:a.inflation||"",labor:a.labor||"6%",fohFix:a.fohFix||"3.50%",fohVar:a.fohVar||"3.50%",incrementalDepreciation:a.incrementalDepreciation||"Keep",cr:a.cr||"",crLabor:a.crLabor||"-3.40%",crFohFix:a.crFohFix||"-2.60%",crFohVar:a.crFohVar||"-2.60%",crIncrementalDepreciation:a.crIncrementalDepreciation||"Keep",pressWelding:a.pressWelding||"3.70%",trComp:a.trComp||"0.00%",nrComp:a.nrComp||"0.00%"},[l,n]=p.useState(i),[o,y]=p.useState(!1),d=h=>{if(h==null)return"";const g=String(h).trim();if(g===""||g.toLowerCase()==="keep")return g;if(g.endsWith("%"))return g.replace(",",".").replace(/\s+/g,"");const T=g.replace(",","."),B=Number(T);return Number.isFinite(B)?`${B.toFixed(2)}%`:g},c=h=>g=>{n(T=>({...T,[h]:g.target.value}))},f=h=>g=>{const T=g.target.value;n(B=>({...B,[h]:d(T)}))},b=async()=>{if(y(!0),!l.reportingPeriod){alert("Reporting Period is required."),y(!1);return}const h={...l},g=T=>{if(T==null)return null;const B=String(T).trim();if(B===""||B.toLowerCase()==="keep")return B===""?null:"Keep";const E=B.replace("%","").replace(",",".").trim(),Y=Number(E);return Number.isFinite(Y)?Y/100:null};h._parsed={labor:g(l.labor),fohFix:g(l.fohFix),fohVar:g(l.fohVar),incrementalDepreciation:l.incrementalDepreciation,crLabor:g(l.crLabor),crFohFix:g(l.crFohFix),crFohVar:g(l.crFohVar),crIncrementalDepreciation:l.crIncrementalDepreciation,pressWelding:g(l.pressWelding),trComp:g(l.trComp),nrComp:g(l.nrComp)},await new Promise(T=>setTimeout(T,600)),y(!1),s&&s(h),r()};return t?e.jsxs("div",{style:{position:"fixed",inset:0,zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center",padding:16},children:[e.jsx("div",{onClick:r,style:{position:"absolute",inset:0,background:"rgba(0,0,0,0.35)"}}),e.jsxs("div",{style:{width:800,maxWidth:"calc(100% - 32px)",background:"#fff",borderRadius:12,boxShadow:"0 20px 60px rgba(2,6,23,0.2)",padding:22,zIndex:1010},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h3",{style:{margin:0},children:"Maintain Master Data"}),e.jsx("div",{children:e.jsx("button",{onClick:r,style:{marginLeft:8},className:"btn btn-ghost",children:"✕"})})]}),e.jsx("div",{style:{marginTop:10,color:"#374151",fontSize:13},children:"Edit master data values. Percent fields accept `6`, `6%`, `3.50`, or `3,50` and format on blur."}),e.jsxs("form",{style:{marginTop:14},onSubmit:h=>{h.preventDefault(),b()},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("label",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("span",{style:{fontSize:13,fontWeight:600,color:"#0b1220",marginBottom:6},children:"Reporting Period"}),e.jsxs("select",{value:l.reportingPeriod,onChange:h=>n(g=>({...g,reportingPeriod:h.target.value})),style:{padding:"8px 10px",borderRadius:8,border:"1px solid rgba(0,0,0,0.12)"},children:[e.jsx("option",{children:"002.2025"}),e.jsx("option",{children:"001.2025"}),e.jsx("option",{children:"003.2025"}),e.jsx("option",{children:"004.2025"})]})]}),e.jsx("div",{}),e.jsx("div",{style:{gridColumn:"1 / -1",marginTop:6},children:e.jsx("div",{style:{fontSize:13,fontWeight:600,color:"#0b1220",marginBottom:8},children:"Inflation"})}),e.jsxs("label",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("span",{style:{fontSize:13,color:"#374151",marginBottom:6},children:"Labor"}),e.jsx("input",{value:l.labor,onChange:c("labor"),onBlur:f("labor"),placeholder:"6%",style:{padding:"8px 10px",borderRadius:8,border:"1px solid rgba(0,0,0,0.12)"}})]}),e.jsxs("label",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("span",{style:{fontSize:13,color:"#374151",marginBottom:6},children:"FOH Fix"}),e.jsx("input",{value:l.fohFix,onChange:c("fohFix"),onBlur:f("fohFix"),placeholder:"3.50%",style:{padding:"8px 10px",borderRadius:8,border:"1px solid rgba(0,0,0,0.12)"}})]}),e.jsxs("label",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("span",{style:{fontSize:13,color:"#374151",marginBottom:6},children:"FOH Var"}),e.jsx("input",{value:l.fohVar,onChange:c("fohVar"),onBlur:f("fohVar"),placeholder:"3.50%",style:{padding:"8px 10px",borderRadius:8,border:"1px solid rgba(0,0,0,0.12)"}})]}),e.jsxs("label",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("span",{style:{fontSize:13,color:"#374151",marginBottom:6},children:"Incremental Depreciation"}),e.jsx("input",{value:l.incrementalDepreciation,onChange:h=>n(g=>({...g,incrementalDepreciation:h.target.value})),style:{padding:"8px 10px",borderRadius:8,border:"1px solid rgba(0,0,0,0.12)"}})]}),e.jsx("div",{style:{gridColumn:"1 / -1",height:1,marginTop:6,borderTop:"1px solid rgba(0,0,0,0.06)"}}),e.jsx("div",{style:{gridColumn:"1 / -1",marginTop:8},children:e.jsx("div",{style:{fontSize:13,fontWeight:600,color:"#0b1220",marginBottom:8},children:"CR"})}),e.jsxs("label",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("span",{style:{fontSize:13,color:"#374151",marginBottom:6},children:"Labor"}),e.jsx("input",{value:l.crLabor,onChange:c("crLabor"),onBlur:f("crLabor"),placeholder:"-3.40%",style:{padding:"8px 10px",borderRadius:8,border:"1px solid rgba(0,0,0,0.12)"}})]}),e.jsxs("label",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("span",{style:{fontSize:13,color:"#374151",marginBottom:6},children:"FOH Fix"}),e.jsx("input",{value:l.crFohFix,onChange:c("crFohFix"),onBlur:f("crFohFix"),placeholder:"-2.60%",style:{padding:"8px 10px",borderRadius:8,border:"1px solid rgba(0,0,0,0.12)"}})]}),e.jsxs("label",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("span",{style:{fontSize:13,color:"#374151",marginBottom:6},children:"FOH Var"}),e.jsx("input",{value:l.crFohVar,onChange:c("crFohVar"),onBlur:f("crFohVar"),placeholder:"-2.60%",style:{padding:"8px 10px",borderRadius:8,border:"1px solid rgba(0,0,0,0.12)"}})]}),e.jsxs("label",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("span",{style:{fontSize:13,color:"#374151",marginBottom:6},children:"Incremental Depreciation"}),e.jsx("input",{value:l.crIncrementalDepreciation,onChange:h=>n(g=>({...g,crIncrementalDepreciation:h.target.value})),style:{padding:"8px 10px",borderRadius:8,border:"1px solid rgba(0,0,0,0.12)"}})]}),e.jsx("div",{style:{gridColumn:"1 / -1",height:1,marginTop:6,borderTop:"1px solid rgba(0,0,0,0.06)"}}),e.jsxs("label",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("span",{style:{fontSize:13,color:"#374151",marginBottom:6},children:"Press & Welding"}),e.jsx("input",{value:l.pressWelding,onChange:c("pressWelding"),onBlur:f("pressWelding"),placeholder:"3.70%",style:{padding:"8px 10px",borderRadius:8,border:"1px solid rgba(0,0,0,0.12)"}})]}),e.jsxs("label",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("span",{style:{fontSize:13,color:"#374151",marginBottom:6},children:"TR Comp"}),e.jsx("input",{value:l.trComp,onChange:c("trComp"),onBlur:f("trComp"),placeholder:"0.00%",style:{padding:"8px 10px",borderRadius:8,border:"1px solid rgba(0,0,0,0.12)"}})]}),e.jsxs("label",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("span",{style:{fontSize:13,color:"#374151",marginBottom:6},children:"NR Comp"}),e.jsx("input",{value:l.nrComp,onChange:c("nrComp"),onBlur:f("nrComp"),placeholder:"0.00%",style:{padding:"8px 10px",borderRadius:8,border:"1px solid rgba(0,0,0,0.12)"}})]})]}),e.jsxs("div",{style:{marginTop:18,display:"flex",justifyContent:"flex-end",gap:8},children:[e.jsx("button",{type:"button",onClick:r,className:"btn btn-ghost",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:o,className:"btn btn-primary",children:o?"Saving...":"Save"})]})]})]})]}):null}const Yt=({isOpen:t,onClose:r,files:a,title:s,onDelete:i})=>{if(!t)return null;const l=n=>{const o=`This is a placeholder for the content of ${n.name}`,y=new Blob([o],{type:"text/csv"}),d=URL.createObjectURL(y),c=document.createElement("a");c.href=d,c.download=n.name,c.click(),URL.revokeObjectURL(d)};return e.jsx("div",{style:ne.overlay,children:e.jsxs("div",{style:ne.modal,children:[e.jsxs("div",{style:ne.header,children:[e.jsx("h2",{children:s}),e.jsx("button",{onClick:r,style:ne.closeButton,children:"×"})]}),e.jsx("div",{style:ne.body,children:a.length>0?a.map((n,o)=>e.jsxs("div",{style:ne.fileCard,children:[e.jsxs("div",{children:[e.jsx("div",{style:ne.fileName,children:n.name}),e.jsxs("div",{style:ne.fileMeta,children:["Uploaded: ",new Date(n.uploadDate).toLocaleString()]})]}),e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsx("button",{onClick:()=>l(n),style:ne.downloadButton,children:"Download"}),e.jsx("button",{onClick:()=>i(n.name),style:ne.deleteButton,children:"Delete"})]})]},o)):e.jsx("p",{children:"No files have been uploaded yet."})})]})})},ne={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},modal:{backgroundColor:"white",padding:"20px",borderRadius:"8px",width:"500px",maxWidth:"90%",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid #eee",paddingBottom:"10px",marginBottom:"20px"},closeButton:{background:"none",border:"none",fontSize:"24px",cursor:"pointer"},body:{maxHeight:"400px",overflowY:"auto"},fileCard:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px",border:"1px solid #ddd",borderRadius:"6px",marginBottom:"10px"},fileName:{fontWeight:"bold"},fileMeta:{fontSize:"12px",color:"#666"},downloadButton:{backgroundColor:"#007bff",color:"white",border:"none",padding:"8px 12px",borderRadius:"6px",cursor:"pointer"},deleteButton:{backgroundColor:"#dc3545",color:"white",border:"none",padding:"8px 12px",borderRadius:"6px",cursor:"pointer"}},lt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAsgAAALIBa5Ro4AAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAJ6SURBVFiF7ZfPi01xGMY/zwz5NdMYDWFW7NyykBKJ/GZI8geoyUZ+LCmrsaBslGIzdmPMbDQLNAtCikiJxhjJQpEIRUrDDDPzWHyP6cyZO/fec85VFp56u6dzvu/7PN9z3/f9vgfbJA04BDwHRgGntD5gfrG4xUwR4TgknQeOAJ+ATuAzlWMfUIhEbLT9taxHYudrol1cBmZUuouY/xVgEBgBHgB15XxqEnq2Rr+nbA+n2Hkcb4FWYDVwVdLMUouTApYAH233ZyQHwHYXIY82AT2SplcqQHmIEyLagWPALqBbUm2xddOqRRjhO9Aoqdb2qO0zkuqBNmBQ0n4nsj75BvLiMbAAOCBJALZPAGcJeXFukkciizuAD2mzP+Y/C3hGqKTXwMOY/ekpR0tVQS7Y/kHI/jZgABiK2T1CiW6J++TKAUkNhFp/FxMxCJycYn1f8l7eJLwALAQ2ZA2Q9y+YG1lmVLsK/gv4ewIU0CVpXYk1BUmXJM2rugDCObEK6JW0sgj5UuAmsD1FzMoF2B4jHNffgOuSlsXIm4FbQB2ww/aXqguIRLyJRIiw28VAQ3S9CNht+0mamKkbke0XklqA20BzdHsE2Gv7btp4marA9iNgDzBMOGBabfdmiZW5Fdu+I2kz0JiVPJeASMT9PP7wDzSism9AUg1h3F6fMnY/sM32UC4Btsck9QDvUwoYKEdeTMAYMGl6td1J+ErKi9qIYxzJHHgJNElaWwWyCYhadQF4NeFBYqhcDvwCbgBNWYfTIsNqPXCR0DNayn2cHgdOE5rMNaDivj4F5hCaVj3QbvvgBL6kgEjETuAwsAKYnVPAT+Ap0GG7O/nwN3kByObnvXUsAAAAAElFTkSuQmCC",Ht={roles:{admin:{sections:["calculation","master"]},dph:{sections:["calculation"]}}},Te={cmd:[{name:"CMD_Report_2023_10_22.csv",uploadDate:"2023-10-22T10:00:00Z"},{name:"CMD_Report_2023_10_21.csv",uploadDate:"2023-10-21T10:00:00Z"}],ifast:[{name:"IFAST_Data_2023_10_22.csv",uploadDate:"2023-10-22T11:00:00Z"}],sap:[{name:"SAP_Export_2023_10_22.csv",uploadDate:"2023-10-22T12:00:00Z"}],process:[{name:"Process_Cost_2023_10.csv",uploadDate:"2023-10-22T12:00:00Z"},{name:"Process_Cost_2023_12.csv",uploadDate:"2023-12-22T12:00:00Z"}],material:[{name:"Material_Cost_2023_10.csv",uploadDate:"2023-10-22T12:00:00Z"}]};function Lt(){const[t]=p.useState([{id:"cmd",name:"CMD",lastUpdate:"2025-10-22"},{id:"ifast",name:"IFAST",lastUpdate:"2025-10-21"},{id:"sap",name:"SAP",lastUpdate:"2025-10-20"}]),[r]=p.useState({lastPeriod:"2025-09"}),[a,s]=p.useState(!1),[i,l]=p.useState(!1),[n,o]=p.useState(null),[y,d]=p.useState([]),[c,f]=p.useState([]),[b,h]=p.useState(!1),[g,T]=p.useState([]),[B,E]=p.useState(""),[Y,k]=p.useState(""),u=JSON.parse(localStorage.getItem("user")),m=u?u.role:"dph",C=A=>{const N=Ht.roles[m];return N&&N.sections.includes(A)},F=p.useMemo(()=>{const A=[...Te.process||[],...c];return A.length===0?null:(A.sort((N,D)=>new Date(D.uploadDate)-new Date(N.uploadDate)),A[0])},[c]),v=p.useMemo(()=>{const A=[...Te.material||[],...y];return A.length===0?null:(A.sort((N,D)=>new Date(D.uploadDate)-new Date(N.uploadDate)),A[0])},[y]),S=be(),M=()=>{localStorage.removeItem("user"),localStorage.removeItem("isAuthenticated"),S("/login")};function w(A){console.log(`Deleting ${A} from ${Y}`),Y==="process"?f(N=>N.filter(D=>D.name!==A)):Y==="material"&&d(N=>N.filter(D=>D.name!==A)),T(N=>N.filter(D=>D.name!==A))}function R(A){const N=Te[A.id]||[];x(A.id,N)}function U(){s(!0)}function te(){s(!1)}function pe(A){const N=A.target.files[0];if(N&&(N.type==="application/vnd.ms-excel"||N.type==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")){const D={name:N.name,size:N.size,uploadDate:new Date().toISOString()};d(I=>[...I,D]),console.log("File uploaded:",N.name)}else alert("Please select a valid Excel file (.xls or .xlsx)")}function re(A){const N=A.target.files[0];if(N&&(N.type==="application/vnd.ms-excel"||N.type==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")){const D={name:N.name,size:N.size,uploadDate:new Date().toISOString()};f(I=>[...I,D]),console.log("Process file uploaded:",N.name)}else alert("Please select a valid Excel file (.xls or .xlsx)")}function x(A,N){T(N),k(A),E(A==="material"?"Download Material Cost Files":A==="process"?"Download Process Cost Files":`Download ${A.toUpperCase()} Files`),h(!0)}function O(){const A=[...Te.process||[],...c];x("process",A)}function L(A){let N="",D;if(A==="process")D="Process,CostType,Amount,Currency\\nLabor,Direct,0,USD\\nFOH,Overhead,0,USD",N="process-cost-template.csv";else if(A==="material")D="Part Number,Material Type,Cost per Unit,Currency\\nPART-001,Steel,0,USD",N="material-cost-template.csv";else return;const I=new Blob([D],{type:"text/csv"}),W=URL.createObjectURL(I),Q=document.createElement("a");Q.href=W,Q.download=N,Q.click(),URL.revokeObjectURL(W)}function ae(){S("/part-pairing")}function q(){console.log("Navigating to Synchronize Part List page..."),S("/sync")}return e.jsxs("div",{className:"app-container",children:[e.jsxs("header",{className:"app-header",children:[e.jsxs("div",{className:"app-header-left",children:[e.jsx("h1",{children:"Dashboard IH Cost"}),e.jsx("p",{children:"Overview of source syncs and master-data tools"})]}),e.jsx("div",{className:"header-actions",children:e.jsx("button",{onClick:M,className:"btn btn-ghost",style:{marginRight:"30px"},children:"Logout"})})]}),e.jsxs("main",{children:[C("data_sync")&&e.jsxs("section",{children:[e.jsx("h2",{className:"section-title",children:"Data Synchronization"}),e.jsxs("div",{className:"grid-5",children:[t.map(A=>e.jsxs(he.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.28},className:"card",children:[e.jsxs("div",{children:[e.jsx("div",{className:"title",children:A.name}),e.jsxs("div",{className:"meta",children:["Last Update: ",e.jsx("span",{children:A.lastUpdate})]})]}),e.jsxs("div",{className:"card-footer",children:[e.jsxs("div",{className:"small",children:["Status: ",e.jsx("strong",{className:"status-ok",children:"OK"})]}),e.jsx("div",{className:"card-actions",children:e.jsx("button",{onClick:()=>R(A),className:"btn btn-primary",children:"Download"})})]})]},A.id)),e.jsx(he.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.28,delay:.05},className:"card arrow-card",children:"➜"}),e.jsxs(he.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.28,delay:.1},className:"card sync-card",children:[e.jsxs("div",{children:[e.jsx("div",{className:"title",children:"Synchronize Part List"}),e.jsx("div",{className:"meta",children:"Combine data from CMD, SAP, and IFAST"})]}),e.jsxs("div",{className:"card-footer",children:[e.jsx("div",{}),e.jsx("div",{className:"card-actions",children:e.jsx("button",{className:"btn btn-primary sync-button",onClick:q,children:"Synchronize"})})]})]})]})]}),C("calculation")&&e.jsxs("section",{children:[e.jsx("h2",{className:"section-title",children:"Calculation"}),e.jsxs("div",{className:"grid-4",children:[e.jsxs(he.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.28,delay:.02},className:"card",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"card-title-flex",children:[e.jsx("div",{className:"title",children:"Process Cost"}),e.jsxs("a",{href:"#",onClick:A=>{A.preventDefault(),L("process")},className:"template-link",children:[e.jsx("img",{src:lt,alt:"Download Template"}),e.jsx("span",{children:"Template"})]})]}),e.jsxs("div",{className:"meta",children:["Last Update: ",e.jsx("span",{children:F?new Date(F.uploadDate).toLocaleDateString("en-CA"):"-"})]}),e.jsx("div",{className:"small card-meta-margin",children:"Labor, FOH, depreciation, and other processing costs used in calculations."})]}),e.jsxs("div",{className:"card-footer",children:[e.jsx("div",{className:"small",children:F?e.jsx("strong",{className:"status-ok",children:"Ready"}):e.jsx("strong",{className:"status-warning",children:"Upload required"})}),e.jsxs("div",{className:"card-actions",children:[e.jsx("input",{type:"file",accept:".xls,.xlsx",onChange:re,style:{display:"none"},id:"process-cost-upload"}),e.jsx("label",{htmlFor:"process-cost-upload",className:"btn btn-ghost upload-label",children:"Upload"}),e.jsx("button",{onClick:O,className:"btn btn-primary",disabled:!F,style:F?{}:{opacity:.5,cursor:"not-allowed"},children:"Download"})]})]})]}),e.jsxs(he.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.28,delay:.04},className:"card",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"card-title-flex",children:[e.jsx("div",{className:"title",children:"Material Cost"}),e.jsxs("a",{href:"#",onClick:A=>{A.preventDefault(),L("material")},className:"template-link",children:[e.jsx("img",{src:lt,alt:"Download Template"}),e.jsx("span",{children:"Template"})]})]}),e.jsxs("div",{className:"meta",children:["Last Update: ",e.jsx("span",{children:v?new Date(v.uploadDate).toLocaleDateString("en-CA"):"-"})]}),e.jsx("div",{className:"small card-meta-margin",children:"Raw material costs, including prices, quantities, and supplier information."})]}),e.jsxs("div",{className:"card-footer",children:[e.jsx("div",{className:"small",children:v?e.jsx("strong",{className:"status-ok",children:"Ready"}):e.jsx("strong",{className:"status-warning",children:"Upload required"})}),e.jsxs("div",{className:"card-actions",children:[e.jsx("input",{type:"file",accept:".xls,.xlsx",onChange:pe,style:{display:"none"},id:"material-cost-upload"}),e.jsx("label",{htmlFor:"material-cost-upload",className:"btn btn-ghost upload-label",children:"Upload"}),e.jsx("button",{onClick:()=>S("/casting-material"),className:"btn btn-primary",disabled:!v,style:v?{}:{opacity:.5,cursor:"not-allowed"},children:"Calculate"})]})]})]}),e.jsx(he.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.28,delay:.06},className:"card arrow-card",children:"➜"}),e.jsxs(he.div,{className:"card ihp-area",initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.28,delay:.08},children:[e.jsxs("div",{children:[e.jsx("div",{className:"title",children:"IHP"}),e.jsx("div",{className:"meta",children:"Perform calculation for IHP metrics across synced sources."}),n&&e.jsxs("div",{className:"small ihp-result",children:["Last result: ",n.value," (calculated at ",new Date(n.timestamp).toLocaleString(),")"]})]}),e.jsxs("div",{className:"card-footer ihp-calc-btn",children:[e.jsx("div",{}),e.jsx("div",{children:e.jsx("button",{onClick:()=>S("/ppr"),disabled:i,className:"btn btn-primary",style:i?{opacity:.7,cursor:"wait"}:{},children:i?"Calculating...":"Calculate IHP"})})]})]})]})]}),C("master")&&e.jsxs("section",{children:[e.jsx("h2",{className:"section-title",children:"Master Data"}),e.jsxs("div",{className:"grid-2",children:[e.jsxs(he.div,{className:"card master-card",initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.28,delay:.04},children:[e.jsxs("div",{children:[e.jsx("div",{className:"title",children:"Master Assumption"}),e.jsxs("div",{className:"meta",children:["Last Period: ",e.jsx("span",{children:r.lastPeriod})]}),e.jsx("div",{className:"small card-meta-margin",children:"Maintain core reference tables used by the synchronization processes. Use the button below to manage values."})]}),e.jsxs("div",{className:"card-footer",children:[e.jsx("div",{}),e.jsxs("div",{className:"card-actions",children:[e.jsx("button",{className:"btn btn-ghost",onClick:()=>alert("View master data (preview)"),children:"View"}),e.jsx("button",{className:"btn btn-primary",onClick:U,children:"Maintain Master Assumption"})]})]})]}),e.jsxs(he.div,{className:"card",initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.28,delay:.08},children:[e.jsxs("div",{children:[e.jsx("div",{className:"title",children:"Part Pairing Management"}),e.jsx("div",{className:"meta",children:"Cross-system part mapping and relationships"}),e.jsx("div",{className:"small card-meta-margin",children:"Manage part number mappings between CMD, SAP, and IFAST systems. Define equivalency relationships and maintain cross-reference tables."})]}),e.jsxs("div",{className:"card-footer",children:[e.jsxs("div",{className:"small",children:["Status: ",e.jsx("strong",{className:"status-ok",children:"Ready"})]}),e.jsx("div",{className:"card-actions",children:e.jsx("button",{className:"btn btn-primary",onClick:ae,children:"Manage Pairings"})})]})]})]})]})]}),e.jsx("div",{className:"page-bottom"}),e.jsx(kt,{open:a,onClose:te,onSave:A=>{console.log("Master data saved:",A)}}),e.jsx(Yt,{isOpen:b,onClose:()=>h(!1),files:g,title:B,onDelete:w})]})}function Kt(){const t=be(),[r,a]=p.useState(1),s=15,i=[["122810Y11000","HANGER, ENGINE, NO.1","SETIA GUNA SEJATI"],["130500Y02000","GEAR ASSY, CAMSHAFT TIMING","DENSO INDONESIA CORPORATION (FAJAR)"],["25051BZ15000","CONVERTER SUB-ASSY, EXHAUST MANIFOLD","FUTABA INDONESIA"],["25051BZ26000","CONVERTER SUB-ASSY, EXHAUST MANIFOLD","FUTABA INDONESIA"],["22030BZ15000","BODY ASSY, THROTTLE W/MOTOR","AISAN NASMOCO INDUSTRI"],["90210T000200","WASHER, SEAL","ARAI RUBBER SEAL INDONESIA"],["90430T002300","GASKET","ARAI RUBBER SEAL INDONESIA"],["111150Y03000","GASKET, CYLINDER HEAD","ASTRA NIPPON GASKET INDONESIA"],["11115BZ16000","GASKET, CYLINDER HEAD","ASTRA NIPPON GASKET INDONESIA"],["171730Y03000","GASKET, EXHAUST MANIFOLD","ASTRA NIPPON GASKET INDONESIA"],["17173BZ13000","GASKET, EXHAUST MANIFOLD","ASTRA NIPPON GASKET INDONESIA"],["115110Y04000","CAP, CRANKSHAFT BEARING, NO.1","AT INDONESIA"],["115130Y04000","CAP, CRANKSHAFT BEARING, NO.3","AT INDONESIA"],["16261BZ75000","HOSE, WATER BY-PASS, NO.1","CATURINDO AGUNGJAYA RUBBER"],["16261BZ76000","HOSE, WATER BY-PASS, NO.1","CATURINDO AGUNGJAYA RUBBER"],["16264BZ38000","HOSE, WATER BY-PASS, NO.2","CATURINDO AGUNGJAYA RUBBER"],["16264BZ39000","HOSE, WATER BY-PASS, NO.2","CATURINDO AGUNGJAYA RUBBER"],["16282BZ11000","HOSE, WATER BY-PASS, NO.5","CATURINDO AGUNGJAYA RUBBER"],["89467BZ02000","SENSOR, AIR FUEL RATIO","DENSO INDONESIA CORPORATION (SIP C)"]],l=p.useMemo(()=>i.map(u=>({partNo:u[0],partName:u[1],supplier:u[2],cmd:!0,sap:Math.random()>.5,ifast:Math.random()>.5})),[]),n=u=>!u&&u!==0?"":String(u).replace(/(.{5})/g,"$1-").replace(/-$/,""),[o,y]=p.useState(!1),[d,c]=p.useState("all"),f=p.useMemo(()=>d==="ifast"?l.filter(u=>u.cmd&&!u.ifast).map(u=>({...u,reasons:["Missing in IFAST"]})):d==="sap"?l.filter(u=>u.cmd&&!u.sap).map(u=>({...u,reasons:["Missing in SAP"]})):l.filter(u=>!(u.cmd&&u.sap&&u.ifast)).map(u=>{const m=[];return u.sap||m.push("Missing in SAP"),u.ifast||m.push("Missing in IFAST"),{...u,reasons:m}}),[l,d]),b=(u="all")=>{c(u),y(!0)},h=(u=null)=>{const m=u||d,C=m==="ifast"?l.filter(R=>R.cmd&&!R.ifast).map(R=>({...R,reasons:["Missing in IFAST"]})):m==="sap"?l.filter(R=>R.cmd&&!R.sap).map(R=>({...R,reasons:["Missing in SAP"]})):l.filter(R=>!(R.cmd&&R.sap&&R.ifast)).map(R=>{const U=[];return R.sap||U.push("Missing in SAP"),R.ifast||U.push("Missing in IFAST"),{...R,reasons:U}}),v=[["Part No","Part Name","Supplier","CMD","SAP","IFAST","Issues"].join(","),...C.map(R=>[n(R.partNo),`"${R.partName.replace(/"/g,'""')}"`,`"${R.supplier.replace(/"/g,'""')}"`,R.cmd?"TRUE":"FALSE",R.sap?"TRUE":"FALSE",R.ifast?"TRUE":"FALSE",`"${R.reasons.join("; ")}"`].join(","))].join(`
`),S=new Blob([v],{type:"text/csv;charset=utf-8;"}),M=URL.createObjectURL(S),w=document.createElement("a");w.href=M,w.download=`sync-compare-results-${m}.csv`,w.click(),URL.revokeObjectURL(M)},g=l.length,T=Math.ceil(g/s),B=(r-1)*s,E=B+s,Y=l.slice(B,E),k=u=>{a(Math.max(1,Math.min(u,T)))};return e.jsx("div",{style:{padding:28},children:e.jsxs("div",{style:{maxWidth:1200,margin:"0 auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:18},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("button",{className:"btn",onClick:()=>t(-1),style:{backgroundColor:"#007bff",color:"white",border:"none"},children:"← Back"}),e.jsx("h1",{style:{margin:0},children:"Synchronize Part List"})]}),e.jsx("p",{style:{margin:"6px 0 0",color:"#6b7280"},children:"Shows which part lists exist in CMD / SAP / IFAST."})]}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{onClick:()=>b("ifast"),className:"btn btn-primary",title:"Compare gap between CMD and IFAST",children:"Compare Gap CMD vs IFAST"}),e.jsx("button",{onClick:()=>b("sap"),className:"btn btn-primary",title:"Compare gap between CMD and SAP",children:"Compare Gap CMD vs SAP"}),e.jsx("button",{onClick:()=>h("all"),className:"btn btn-primary",title:"Export CSV (download comparison of CMD/SAP/IFAST)",children:"Export CSV"})]})]}),e.jsx("div",{style:{overflowX:"auto",borderRadius:12,border:"1px solid rgba(0,0,0,0.06)"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",minWidth:950},children:[e.jsx("thead",{style:{background:"rgba(15,23,42,0.03)"},children:e.jsxs("tr",{children:[e.jsx("th",{style:Ne,children:"Record No"}),e.jsx("th",{style:Ut,children:"Part No"}),e.jsx("th",{style:zt,children:"Part Name"}),e.jsx("th",{style:Ne,children:"Supplier Name"}),e.jsx("th",{style:Ne,children:"CMD"}),e.jsx("th",{style:Ne,children:"SAP"}),e.jsx("th",{style:Ne,children:"IFAST"})]})}),e.jsx("tbody",{children:Y.map((u,m)=>{const C=B+m+1;return e.jsxs("tr",{style:{borderBottom:"1px solid rgba(0,0,0,0.04)"},children:[e.jsx("td",{style:Me,children:C}),e.jsx("td",{style:Vt,children:n(u.partNo)}),e.jsx("td",{style:_t,children:u.partName}),e.jsx("td",{style:He,children:u.supplier}),e.jsx("td",{style:Me,children:e.jsx("input",{type:"checkbox",checked:u.cmd,readOnly:!0})}),e.jsx("td",{style:Me,children:e.jsx("input",{type:"checkbox",checked:u.sap,readOnly:!0})}),e.jsx("td",{style:Me,children:e.jsx("input",{type:"checkbox",checked:u.ifast,readOnly:!0})})]},u.partNo)})})]})}),o&&e.jsx("div",{style:{position:"fixed",left:0,top:0,right:0,bottom:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:e.jsxs("div",{style:{width:920,maxHeight:"80vh",overflow:"auto",background:"white",borderRadius:8,padding:18},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("h3",{style:{margin:0},children:d==="ifast"?"Compare: CMD vs IFAST":d==="sap"?"Compare: CMD vs SAP":"Compare Results (CMD / SAP / IFAST)"}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{className:"btn btn-ghost",onClick:()=>y(!1),children:"Close"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>h(),disabled:f.length===0,children:"Export CSV"})]})]}),e.jsxs("div",{style:{marginBottom:8,color:"#374151"},children:["Mismatched records: ",e.jsx("strong",{children:f.length}),d==="ifast"&&" (rows where IFAST is missing)",d==="sap"&&" (rows where SAP is missing)",d==="all"&&" (rows missing SAP or IFAST)"]}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{style:{background:"#f3f4f6"},children:e.jsxs("tr",{children:[e.jsx("th",{style:{textAlign:"left",padding:"8px 10px"},children:"Part No"}),e.jsx("th",{style:{textAlign:"left",padding:"8px 10px"},children:"Part Name"}),e.jsx("th",{style:{textAlign:"left",padding:"8px 10px"},children:"Supplier"}),e.jsx("th",{style:{textAlign:"center",padding:"8px 10px"},children:"CMD"}),d==="ifast"&&e.jsx("th",{style:{textAlign:"center",padding:"8px 10px"},children:"IFAST"}),d==="sap"&&e.jsx("th",{style:{textAlign:"center",padding:"8px 10px"},children:"SAP"}),d==="all"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{style:{textAlign:"center",padding:"8px 10px"},children:"SAP"}),e.jsx("th",{style:{textAlign:"center",padding:"8px 10px"},children:"IFAST"})]}),e.jsx("th",{style:{textAlign:"left",padding:"8px 10px"},children:"Issues"})]})}),e.jsxs("tbody",{children:[f.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:d==="all"?6:5,style:{padding:12,color:"#6b7280"},children:"No mismatches found."})}),f.map(u=>e.jsxs("tr",{style:{borderBottom:"1px solid rgba(0,0,0,0.04)"},children:[e.jsx("td",{style:{padding:"8px 10px"},children:n(u.partNo)}),e.jsx("td",{style:{padding:"8px 10px"},children:u.partName}),e.jsx("td",{style:{padding:"8px 10px"},children:u.supplier}),e.jsx("td",{style:{textAlign:"center",padding:"8px 10px"},children:u.cmd?"✓":"—"}),d==="ifast"&&e.jsx("td",{style:{textAlign:"center",padding:"8px 10px"},children:u.ifast?"✓":"—"}),d==="sap"&&e.jsx("td",{style:{textAlign:"center",padding:"8px 10px"},children:u.sap?"✓":"—"}),d==="all"&&e.jsxs(e.Fragment,{children:[e.jsx("td",{style:{textAlign:"center",padding:"8px 10px"},children:u.sap?"✓":"—"}),e.jsx("td",{style:{textAlign:"center",padding:"8px 10px"},children:u.ifast?"✓":"—"})]}),e.jsx("td",{style:{padding:"8px 10px",color:"#b91c1c"},children:u.reasons.join("; ")})]},u.partNo))]})]})]})}),e.jsxs("div",{style:{marginTop:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{fontSize:13,color:"#6b7280"},children:["Showing ",B+1," to ",Math.min(E,g)," of ",g," records"]}),e.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[e.jsx("button",{onClick:()=>k(r-1),disabled:r===1,className:"btn btn-ghost",style:{padding:"4px 8px",fontSize:12,opacity:r===1?.5:1,cursor:r===1?"not-allowed":"pointer"},children:"Previous"}),Array.from({length:T},(u,m)=>m+1).map(u=>e.jsx("button",{onClick:()=>k(u),className:u===r?"btn btn-primary":"btn btn-ghost",style:{padding:"4px 8px",fontSize:12,minWidth:32},children:u},u)),e.jsx("button",{onClick:()=>k(r+1),disabled:r===T,className:"btn btn-ghost",style:{padding:"4px 8px",fontSize:12,opacity:r===T?.5:1,cursor:r===T?"not-allowed":"pointer"},children:"Next"})]})]}),e.jsx("div",{style:{marginTop:16,display:"flex",justifyContent:"flex-end",gap:8}})]})})}const qe={textAlign:"left",padding:"12px 14px",fontSize:13,color:"#0b1220",fontWeight:600},Ne={...qe,textAlign:"center"},He={padding:"12px 14px",fontSize:13,color:"#374151"},Me={...He,textAlign:"center"},Ut={...qe,padding:"12px 20px",minWidth:160,textAlign:"center"},Vt={...He,padding:"12px 20px",minWidth:160},zt={...qe,padding:"12px 20px",minWidth:300,textAlign:"center"},_t={...He,padding:"12px 20px",minWidth:300},oe=({filled:t})=>e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:t?"currentColor":"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M3 4H21V6.58579C21 7.11236 20.7893 7.61714 20.4142 8L14 14.4142V20L10 22V14.4142L3.58579 8C3.21071 7.61714 3 7.11236 3 6.58579V4Z"})}),ie=({title:t,values:r,onApply:a,onClose:s,initialCheckedValues:i})=>{const[l,n]=p.useState(""),[o,y]=p.useState(i),d=r.filter(b=>b.toLowerCase().includes(l.toLowerCase())),c=b=>{b.target.checked?y(d):y([])},f=b=>{y(h=>h.includes(b)?h.filter(g=>g!==b):[...h,b])};return e.jsxs("div",{style:{position:"absolute",top:"40px",left:"0",backgroundColor:"white",border:"1px solid #ccc",borderRadius:"8px",padding:"16px",zIndex:100,boxShadow:"0 4px 8px rgba(0,0,0,0.1)",width:"250px"},children:[e.jsxs("h3",{style:{marginTop:0,marginBottom:"12px"},children:["Filter by ",t]}),e.jsx("input",{type:"text",placeholder:"Search...",value:l,onChange:b=>n(b.target.value),style:{width:"100%",padding:"8px",marginBottom:"12px",borderRadius:"4px",border:"1px solid #ccc"}}),e.jsxs("div",{style:{maxHeight:"200px",overflowY:"auto",textAlign:"left"},children:[e.jsxs("div",{children:[e.jsx("input",{type:"checkbox",id:"select-all",checked:d.length>0&&o.length===d.length,onChange:c}),e.jsx("label",{htmlFor:"select-all",style:{marginLeft:"8px",fontWeight:"bold"},children:"Select All"})]}),d.map(b=>e.jsxs("div",{children:[e.jsx("input",{type:"checkbox",id:b,checked:o.includes(b),onChange:()=>f(b)}),e.jsx("label",{htmlFor:b,style:{marginLeft:"8px"},children:b})]},b))]}),e.jsxs("div",{style:{marginTop:"16px",display:"flex",justifyContent:"flex-end",gap:"8px"},children:[e.jsx("button",{onClick:s,style:{padding:"8px 16px",borderRadius:"4px",border:"1px solid #ccc"},children:"Cancel"}),e.jsx("button",{onClick:()=>a(o),style:{padding:"8px 16px",borderRadius:"4px",border:"none",backgroundColor:"#2563eb",color:"white"},children:"Apply"})]})]})},xt="/finance-dashboard/assets/xls_icon-B-n79uUi.png",Wt="/finance-dashboard/assets/chat_icon-uo6WY_Ql.png",Gt=({selectedPeriod:t,comparisonPeriod:r,availablePeriods:a,onPeriodChange:s,onComparisonPeriodChange:i,onDownload:l,isDirty:n,onSave:o,isDphUser:y,onToggleNotices:d})=>e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",alignItems:"center",marginBottom:16},children:e.jsx("div",{style:{display:"flex",alignItems:"center"},children:e.jsx("h1",{style:{fontSize:24,fontWeight:"bold",color:"#1F2937"},children:"Cost Analysis Report"})})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"#4B5563"},children:"Select Period:"}),e.jsx("select",{value:t,onChange:c=>s(c.target.value),style:{padding:"6px 10px",borderRadius:4,border:"1px solid #d1d5db",fontSize:12},children:a.map(c=>e.jsx("option",{value:c,children:c},c))})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"#4B5563"},children:"Compare with:"}),e.jsx("select",{value:r,onChange:c=>i(c.target.value),style:{padding:"6px 10px",borderRadius:4,border:"1px solid #d1d5db",fontSize:12},children:a.map(c=>e.jsx("option",{value:c,children:c},c))})]})]}),e.jsxs("div",{style:{display:"flex",gap:8},children:[n&&!y&&e.jsx("button",{onClick:o,style:{padding:"8px 16px",borderRadius:4,border:"1px solid #d1d5db",backgroundColor:"#FFC107",color:"white",fontSize:12,cursor:"pointer"},children:"Save"}),e.jsx("button",{style:{padding:"8px 16px",borderRadius:4,border:"1px solid #d1d5db",backgroundColor:"#4CAF50",color:"white",fontSize:12,cursor:n?"not-allowed":"pointer",opacity:n?.5:1},disabled:n,children:"Submit"}),e.jsxs("button",{onClick:l,style:{display:"flex",alignItems:"center",padding:"8px 16px",borderRadius:4,border:"1px solid #d1d5db",backgroundColor:"#2196F3",color:"white",fontSize:12,cursor:n?"not-allowed":"pointer",opacity:n?.5:1},disabled:n,children:["Download",e.jsx("img",{src:xt,alt:"Download",style:{marginLeft:8,height:16}})]}),e.jsx("button",{onClick:d,style:{display:"flex",alignItems:"center",padding:"8px",borderRadius:4,border:"1px solid #d1d5db",backgroundColor:"#fff",cursor:"pointer"},children:e.jsx("img",{src:Wt,alt:"Notices",style:{height:16}})})]})]})]}),ye=["Tooling OH","Raw Material","Total Purchase Cost","Labor","FOH Fix","FOH Var","Depre Common","Depre Exclusive","Total Process Cost","Total Cost","Manhour","Sales Volume","Prod Volume"],Zt=["Rp.","Rp.","Rp","Rp.","Rp.","Rp.","Rp","Rp.","Rp.","Rp.","mins","Rp.","Units"],le=["Volume","Inflation","CR","Material Price Impact","Gentan-I Impact","Material Change"],Le={"Tooling OH":"tooling_oh","Raw Material":"raw_material",Labor:"labor","FOH Fix":"foh_fixed","FOH Var":"foh_var","Depre Common":"depre_common","Depre Exclusive":"depre_exclusive","Total Cost":"total_cost",Manhour:"mh_cost","Sales Volume":"sales_volume","Prod Volume":"prod_volume"},Jt={Volume:"volume",Inflation:"inflation",CR:"CR","Material Price Impact":"material_price_impact","Gentan-I Impact":"gentan_i_impact","Material Change":"material_change"},fe=["Tooling OH","Raw Material"],ce=["Labor","FOH Fix","FOH Var","Depre Common","Depre Exclusive"],X=(t,r,a)=>{if(!t.months||!t.months[r])return null;const s=Le[a];return t.months[r][s]},Ge=(t,r)=>!t||!r?null:(t-r)/r*100,Ze=(t,r,a)=>`${t}:::${r}:::${a}`,Ke=(t,r,a,s)=>{const i=Ze(t,r,a);return s.hasOwnProperty(i)?s[i]:void 0},ut=(t,r,a)=>{const s=Le[r],i=Ke(t.part_no,r,"PBMD",a);return i!==void 0?i:t.months&&t.months.pbmd_values?t.months.pbmd_values[s]:""},ft=(t,r,a)=>{const s=Le[r],i=Ke(t.part_no,r,"Adj",a);return i!==void 0?i:t.months&&t.months.adj_values?t.months.adj_values[s]:""},mt=(t,r,a)=>r.reduce((s,i)=>{const l=parseFloat(a(t,i))||0;return s+l},0),Ie=(t,r,a)=>mt(t,r,(s,i)=>ut(s,i,a)),Ee=(t,r,a)=>mt(t,r,(s,i)=>ft(s,i,a)),Je=(t,r,a)=>{const s=Ke(t.part_no,r,"Remark",a);return s!==void 0?s:""},$t=(t,r,a)=>{const s=Jt[a]||a.toLowerCase().replace(/ /g,"_"),i=Le[r];return t.months&&t.months[s]&&t.months[s][i]!==void 0?t.months[s][i]:""},Ue=(t,r,a,s)=>{const i=Ke(t.part_no,r,a,s);if(i!==void 0)return i;const l=$t(t,r,a);return l!=null&&l!==""?l:""},De=(t,r,a,s)=>{let i,l;if(r==="Total Purchase Cost")i=(X(t,a,"Tooling OH")||0)+(X(t,a,"Raw Material")||0),l=(X(t,s,"Tooling OH")||0)+(X(t,s,"Raw Material")||0);else if(r==="Total Process Cost")i=ce.map(y=>X(t,a,y)||0).reduce((y,d)=>y+d,0),l=ce.map(y=>X(t,s,y)||0).reduce((y,d)=>y+d,0);else if(r==="Total Cost"){const n=fe.map(c=>X(t,a,c)||0),o=ce.map(c=>X(t,a,c)||0);i=n.reduce((c,f)=>c+f,0)+o.reduce((c,f)=>c+f,0);const y=fe.map(c=>X(t,s,c)||0),d=ce.map(c=>X(t,s,c)||0);l=y.reduce((c,f)=>c+f,0)+d.reduce((c,f)=>c+f,0)}else i=X(t,a,r),l=X(t,s,r);return{currentValue:i,previousValue:l}},ot=(t,r,a)=>{let s,i;return r==="Total Purchase Cost"?(s=Ie(t,fe,a),i=Ee(t,fe,a)):r==="Total Process Cost"?(s=Ie(t,ce,a),i=Ee(t,ce,a)):r==="Total Cost"?(s=Ie(t,fe,a)+Ie(t,ce,a),i=Ee(t,fe,a)+Ee(t,ce,a)):(s=ut(t,r,a)||"",i=ft(t,r,a)||""),{pbmdDisplayValue:s,adjDisplayValue:i}},Fe=(t,r,a,s)=>{let i=0;for(const l of r){const n=Ue(t,l,a,s),o=parseFloat(n);isNaN(o)||(i+=o)}return i},qt=(t,r,a,s)=>{if(r==="Total Purchase Cost")return Fe(t,fe,a,s);if(r==="Total Process Cost")return Fe(t,ce,a,s);if(r==="Total Cost"){const i=Fe(t,fe,a,s),l=Fe(t,ce,a,s);return i+l}return Ue(t,r,a,s)};function Qt(t){const{part:r,costItem:a,idx:s,selectedPeriod:i,comparisonPeriod:l,calculateCostValues:n,calculateDiff:o,getDisplayValues:y,handleCellChange:d,analysisData:c,filteredCostItemsCount:f}=t,{currentValue:b,previousValue:h}=n(r,a,i,l),{pbmdDisplayValue:g,adjDisplayValue:T}=y(r,a,c),[B,E]=p.useState(!1),Y=b!==null&&h!==null?b-h:null,k=o(b,h),u=s===f-1,m=a==="Total Purchase Cost"||a==="Total Process Cost"||a==="Total Cost",C=m||a==="Total Cost",F=ye.indexOf(a),v=F!==-1?Zt[F]:"";return e.jsxs("tr",{style:{borderBottom:u?"3px solid #d1d5db":"1px solid #e5e7eb",background:C?"#f9facd":s%2===0?"#fafafa":"#fff"},children:[s===0&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"td-default",rowSpan:f,style:{fontWeight:"bold",background:"#e8f1f7",verticalAlign:"middle",borderRight:"2px solid #d1d5db",paddingLeft:"2px"},children:r.part_no}),e.jsx("td",{className:"td-default",rowSpan:f,style:{fontWeight:"bold",background:"#e8f1f7",verticalAlign:"middle",borderRight:"2px solid #d1d5db"},children:r.importer}),e.jsx("td",{className:"td-default",rowSpan:f,style:{fontWeight:"bold",background:"#e8f1f7",verticalAlign:"middle",borderRight:"2px solid #d1d5db"},children:r.category})]}),e.jsx("td",{className:"td-default",style:{fontWeight:C?"bold":500,borderRight:"1px solid #e5e7eb"},children:a}),e.jsx("td",{className:"td-default",style:{borderRight:"1px solid #e5e7eb"},children:v}),e.jsx("td",{className:"td-default",style:{textAlign:"right",fontWeight:C?"bold":"normal",padding:"6px"},children:h?h.toLocaleString(void 0,{maximumFractionDigits:0}):"-"}),e.jsx("td",{className:"td-default",style:{textAlign:"right",fontWeight:C?"bold":"normal",padding:"6px"},children:g||"-"}),e.jsx("td",{className:"td-default",style:{textAlign:"right",fontWeight:C?"bold":"normal",padding:"6px"},children:b?b.toLocaleString(void 0,{maximumFractionDigits:0}):"-"}),e.jsx("td",{className:"td-default",style:{textAlign:"right",fontWeight:C?"bold":"normal",padding:"6px"},children:Y!==null?Y.toLocaleString(void 0,{maximumFractionDigits:0}):"-"}),e.jsx("td",{className:"td-default",style:{textAlign:"right",color:k&&Math.abs(k)>15?"#dc2626":"inherit",fontWeight:C?"bold":k&&Math.abs(k)>15?600:"normal",padding:"6px"},children:k?`(${k.toFixed(2)}%)`:"-"}),e.jsx("td",{className:"td-default",style:{textAlign:"center"},children:e.jsx("input",{type:"text",placeholder:"-",value:T,onChange:S=>d(r.part_no,a,"Adj",S.target.value),style:{width:"100%",padding:"6px",border:"1px solid #d1d5db",borderRadius:3,fontSize:11,textAlign:"right",fontWeight:C?"bold":"normal"},disabled:m})}),le.map(S=>{const M=m?qt(r,a,S,c):Ue(r,a,S,c),w=M!==null&&M!==""&&M!==void 0?typeof M=="number"?M.toLocaleString(void 0,{maximumFractionDigits:0}):M:"-",R=!["Volume","Inflation","CR","Material Price Impact","Gentan-I Impact","Material Change"].includes(S);return e.jsx("td",{className:"td-default",style:{textAlign:"center"},children:R?e.jsx("input",{type:"text",placeholder:"-",value:w==="-"?"":w,onChange:U=>d(r.part_no,a,S,U.target.value),style:{width:"100%",padding:"4px",border:"1px solid #d1d5db",borderRadius:3,fontSize:11,textAlign:"right",fontWeight:C?"bold":"normal"},disabled:m}):e.jsx("span",{style:{padding:"4px",fontSize:11,fontWeight:C?"bold":"normal",textAlign:"right",display:"block"},children:w})},S)}),e.jsx("td",{className:"td-default",style:{textAlign:"center"},onClick:()=>!m&&E(!0),children:B?e.jsx("textarea",{placeholder:"-",value:m?"":Je(r,a,c)||"",onChange:S=>d(r.part_no,a,"Remark",S.target.value),onBlur:()=>E(!1),autoFocus:!0,style:{width:"100%",minHeight:"50px",padding:"4px",border:"1px solid #d1d5db",borderRadius:3,fontSize:11,textAlign:"left",resize:"vertical"},disabled:m}):e.jsx("span",{style:{display:"block",width:"100%",minHeight:"24px",textAlign:"left",whiteSpace:"pre-wrap"},children:m?"":Je(r,a,c)||""})})]})}function Xt(t){const{filteredMspData:r,filterStates:a,toggleFilter:s,uniquePartNos:i,uniqueImporters:l,uniqueCategories:n,filteredPartNos:o,filteredImporters:y,filteredCategories:d,onApplyFilter:c,onApplyImporterFilter:f,onApplyCategoryFilter:b,selectedPeriod:h,comparisonPeriod:g,calculateCostValues:T,calculateDiff:B,getDisplayValues:E,handleCellChange:Y,analysisData:k,toggleThresholdFilter:u,thresholdActive:m,filteredCostItems:C,onApplyCostItemFilter:F}=t,v=Object.values(a).some(R=>R),[S,M]=p.useState(!1),w=R=>{F(R),M(!1)};return e.jsxs("div",{style:{overflow:"auto",height:"calc(100vh - 250px)",background:"#fff"},children:[e.jsx("div",{style:{padding:"8px 0px",background:"#fff",borderBottom:"1px solid #d1d5db",display:"flex",gap:"8px",position:"sticky",top:0,zIndex:11},children:e.jsx("button",{onClick:u,style:{padding:"6px 12px",fontSize:12,background:m?"#2563eb":"#e5e7eb",color:m?"#fff":"#1f2937",border:"1px solid #d1d5db",borderRadius:4,cursor:"pointer"},children:"Threshold"})}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[e.jsxs("thead",{style:{position:"sticky",top:45,zIndex:10},children:[e.jsxs("tr",{style:{borderBottom:"1px solid #d1d5db"},children:[e.jsxs("th",{rowSpan:2,className:"tbl-header",style:{minWidth:120,position:"relative"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"Part No"}),e.jsx("span",{style:{cursor:"pointer"},onClick:()=>!v||a.partNo?s("partNo"):null,children:e.jsx(oe,{filled:o.length<i.length})})]}),a.partNo&&e.jsx(ie,{title:"Part No",values:i,initialCheckedValues:o,onApply:c,onClose:()=>s("partNo")})]}),e.jsxs("th",{rowSpan:2,className:"tbl-header",style:{position:"relative"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"Importer"}),e.jsx("span",{style:{cursor:"pointer"},onClick:()=>!v||a.importer?s("importer"):null,children:e.jsx(oe,{filled:y.length<l.length})})]}),a.importer&&e.jsx(ie,{title:"Importer",values:l,initialCheckedValues:y,onApply:f,onClose:()=>s("importer")})]}),e.jsxs("th",{rowSpan:2,className:"tbl-header",style:{position:"relative"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"Category"}),e.jsx("span",{style:{cursor:"pointer"},onClick:()=>!v||a.category?s("category"):null,children:e.jsx(oe,{filled:d.length<n.length})})]}),a.category&&e.jsx(ie,{title:"Category",values:n,initialCheckedValues:d,onApply:b,onClose:()=>s("category")})]}),e.jsxs("th",{colSpan:2,className:"tbl-header",style:{position:"relative"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"Cost Item"}),e.jsx("span",{style:{cursor:"pointer"},onClick:()=>M(!0),children:e.jsx(oe,{filled:C.length<ye.length})})]}),S&&e.jsx(ie,{title:"Cost Item",values:ye,initialCheckedValues:C,onApply:w,onClose:()=>M(!1)})]}),e.jsx("th",{colSpan:6,style:{textAlign:"center",padding:"8px",background:"#a8d8f0",fontWeight:600,borderBottom:"1px solid #d1d5db"},children:"Calculation"}),e.jsx("th",{colSpan:le.length,style:{textAlign:"center",padding:"8px",background:"#f5d5a8",fontWeight:600,borderBottom:"1px solid #d1d5db"},children:"Analysis"}),e.jsx("th",{rowSpan:2,className:"tbl-header",style:{minWidth:150,background:"#bbfebb"},children:"Remark"})]}),e.jsxs("tr",{style:{borderBottom:"1px solid #d1d5db"},children:[e.jsx("th",{className:"tbl-header",children:"Cost Item"}),e.jsx("th",{className:"tbl-header",children:"UoM"}),e.jsx("th",{className:"tbl-header",style:{minWidth:80,background:"#e3f6ff"},children:g}),e.jsxs("th",{className:"tbl-header",style:{minWidth:80,background:"#e3f6ff"},children:["PBMD",e.jsx("br",{}),`${g}`]}),e.jsx("th",{className:"tbl-header",style:{minWidth:80,background:"#e3f6ff"},children:h}),e.jsx("th",{className:"tbl-header",style:{minWidth:60,background:"#e3f6ff"},children:"Diff Amt"}),e.jsx("th",{className:"tbl-header",style:{minWidth:50,background:"#e3f6ff"},children:"Diff %"}),e.jsx("th",{className:"tbl-header",style:{minWidth:60,background:"#e3f6ff"},children:"Adj Value"}),le.map(R=>e.jsx("th",{className:"tbl-header",style:{minWidth:70,background:"#faebd7"},children:R},R))]})]}),e.jsx("tbody",{children:r.map(R=>C.map((U,te)=>e.jsx(Qt,{part:R,costItem:U,idx:te,filteredCostItemsCount:C.length,selectedPeriod:h,comparisonPeriod:g,calculateCostValues:T,calculateDiff:B,getDisplayValues:E,handleCellChange:Y,analysisData:k},`${R.part_no}-${U}`)))})]})]})}const Qe=({currentPage:t,totalPages:r,goToPage:a,totalRecords:s,startIndex:i,endIndex:l,itemsPerPage:n,onItemsPerPageChange:o})=>{const y=[5,10,25,50,100];return e.jsxs("div",{style:{marginTop:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsxs("div",{style:{fontSize:13,color:"#6b7280"},children:["Showing ",i+1," to ",Math.min(l,s)," of"," ",s," records"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("select",{value:n,onChange:d=>o(Number(d.target.value)),style:{padding:"4px 8px",fontSize:12},children:y.map(d=>e.jsx("option",{value:d,children:d},d))}),e.jsx("span",{style:{fontSize:13,color:"#6b7280"},children:"per page"})]})]}),e.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[e.jsx("button",{onClick:()=>a(t-1),disabled:t===1,className:"btn btn-ghost",style:{padding:"4px 8px",fontSize:12,opacity:t===1?.5:1,cursor:t===1?"not-allowed":"pointer"},children:"Previous"}),Array.from({length:r},(d,c)=>c+1).map(d=>e.jsx("button",{onClick:()=>a(d),className:d===t?"btn btn-primary":"btn btn-ghost",style:{padding:"4px 8px",fontSize:12,minWidth:32},children:d},d)),e.jsx("button",{onClick:()=>a(t+1),disabled:t===r,className:"btn btn-ghost",style:{padding:"4px 8px",fontSize:12,opacity:t===r?.5:1,cursor:t===r?"not-allowed":"pointer"},children:"Next"})]})]})},er=({from:t,fromDept:r,to:a,toDept:s,timestamp:i,message:l})=>e.jsxs("div",{style:{backgroundColor:"#f8f9fa",border:"1px solid #dee2e6",borderRadius:"0.25rem",padding:"1rem",margin:"1rem",maxWidth:"80%",alignSelf:"flex-start",position:"relative"},children:[e.jsxs("div",{style:{fontSize:12,color:"#6c757d",position:"absolute",top:"0.5rem",right:"0.5rem"},children:[e.jsx("i",{className:"far fa-clock"})," ",i]}),e.jsxs("div",{style:{fontSize:12,textAlign:"left"},children:[e.jsxs("span",{style:{fontWeight:"bold"},children:["From: ",t]}),e.jsx("br",{}),e.jsx("span",{children:r}),e.jsx("br",{}),e.jsxs("span",{style:{fontWeight:"bold"},children:["To: ",a]}),e.jsx("br",{}),e.jsx("span",{children:s})]}),e.jsx("p",{style:{fontSize:12,marginTop:"1rem",textAlign:"left"},children:l})]}),tr=({isOpen:t,onClose:r,isDphUser:a})=>{if(!t)return null;const s=[{from:"09105014 - YOPI PARADA E.H.",fromDept:"Finance Dept",to:"01526996 - Yunita Aldora",toDept:"Finance Dept",timestamp:"16/12/2025 13:50",message:"Tolong lengkapi Remark utk Material Cost"},{from:"09105014 - YOPI PARADA E.H.",fromDept:"Finance Dept",to:"2010456 - Suharno",toDept:"Finance Dept",timestamp:"17/12/2025 09:50",message:"Periksa kembali Total Material Cost value, pastikan tidak lewat threshold lebih dari 7%"}];return e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:r,children:e.jsxs("div",{style:{width:"500px",background:"#fff",borderRadius:"5px",border:"1px solid #ccc"},onClick:i=>i.stopPropagation(),children:[e.jsxs("div",{style:{padding:"10px",backgroundColor:"#357ab7",color:"white",display:"flex",justifyContent:"space-between",alignItems:"center",borderTopLeftRadius:"5px",borderTopRightRadius:"5px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx("i",{className:"far fa-comment-alt",style:{marginRight:"8px"}}),e.jsx("h3",{style:{margin:0,fontSize:"16px"},children:"Notice"})]}),e.jsx("button",{onClick:r,style:{background:"transparent",border:"none",color:"white",fontSize:"20px",cursor:"pointer"},children:"×"})]}),a&&e.jsxs("div",{style:{padding:"10px",borderBottom:"1px solid #ccc",display:"flex",alignItems:"center",background:"#e9ecef"},children:[e.jsx("input",{id:"to-input",type:"text",defaultValue:"Yunita Aldora",style:{flexGrow:1,border:"1px solid #ccc",borderRadius:"3px",padding:"5px"}}),e.jsx("button",{style:{marginLeft:"10px",border:"1px solid #ccc",borderRadius:"3px",padding:"5px",background:"#f0f0f0"},children:e.jsx("i",{className:"fas fa-search"})}),e.jsx("button",{style:{marginLeft:"5px",border:"1px solid #ccc",borderRadius:"3px",padding:"5px",background:"#f0f0f0"},children:e.jsx("i",{className:"fas fa-sync-alt"})})]}),e.jsx("div",{className:"messages",style:{maxHeight:"300px",overflowY:"auto",background:"#fff"},children:s.map((i,l)=>e.jsx(er,{...i},l))}),a&&e.jsxs("div",{style:{padding:"10px",borderTop:"1px solid #ccc",display:"flex",background:"#f8f9fa"},children:[e.jsx("input",{type:"text",placeholder:"Type your message here...",style:{flexGrow:1,border:"1px solid #ccc",borderRadius:"3px",padding:"5px"}}),e.jsx("button",{style:{marginLeft:"10px",border:"none",borderRadius:"3px",padding:"5px 10px",background:"#ffc107",color:"white",cursor:"pointer"},children:"Send"})]})]})})};function rr(){const t=be(),[r,a]=p.useState([]),[s,i]=p.useState([]),[l,n]=p.useState("2025-02"),[o,y]=p.useState("2024-08"),[d,c]=p.useState({}),[f,b]=p.useState({partNo:!1,importer:!1,category:!1}),[h,g]=p.useState([]),[T,B]=p.useState([]),[E,Y]=p.useState([]),k=JSON.parse(localStorage.getItem("user")),u=k&&k.role==="DpH"?["Total Purchase Cost","Total Process Cost","Total Cost"]:ye,[m,C]=p.useState(u),[F,v]=p.useState(1),[S,M]=p.useState(!1),[w,R]=p.useState(5),[U,te]=p.useState(!1),[pe,re]=p.useState(!1),x=k?.role==="DpH",O=j=>{R(j),v(1)},L=()=>{x?(localStorage.removeItem("isAuthenticated"),localStorage.removeItem("user"),t("/login")):t("/")},ae=()=>{const j={...d};r.filter(G=>je.includes(G.part_no)).forEach(G=>{ye.forEach(_=>{const se=Ze(G.part_no,_,"Adj"),V=j[se],{currentValue:K}=De(G,_,l,o);console.log("Adj Value:",V,"Selected Period Value:",K),(V==null||V===""||V==0)&&(j[se]=K)})}),c(j),te(!1)};async function q(){const j=new ht.Workbook,P=j.addWorksheet("PPR Table");P.addRow(["Part No","Importer","Category","Cost Item","Calculation","","","","","","Analysis",...Array(le.length-1).fill(""),"Remark"]),P.addRow(["","","","",o,`PBMD ${o}`,l,"Diff Amt","Diff %","Adj Value",...le,""]),P.mergeCells("E1:J1"),P.mergeCells(`K1:${String.fromCharCode(75+le.length-1)}1`),P.mergeCells("A1:A2"),P.mergeCells("B1:B2"),P.mergeCells("C1:C2"),P.mergeCells("D1:D2"),P.mergeCells(`${String.fromCharCode(75+le.length)}1:${String.fromCharCode(75+le.length)}2`),P.getRow(1).font={bold:!0},P.getRow(2).font={bold:!0},P.columns=[{header:"Part No",key:"part_no",width:15},{header:"Importer",key:"importer",width:15},{header:"Category",key:"category",width:15},{header:"Cost Item",key:"cost_item",width:20},{header:o,key:"prev",width:15},{header:`PBMD ${o}`,key:"pbmd",width:18},{header:l,key:"curr",width:15},{header:"Diff Amt",key:"diff_amt",width:15},{header:"Diff %",key:"diff_pct",width:10},{header:"Adj Value",key:"adj",width:15},...le.map(K=>({header:K,key:K,width:15})),{header:"Remark",key:"remark",width:20}],P.getRow(1).eachCell((K,J)=>{K.font={bold:!0},K.alignment={vertical:"middle",horizontal:"center"},J>=5&&J<=10&&(K.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFA8D8F0"}}),J>=11&&J<11+le.length&&(K.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF5D5A8"}}),J===P.columns.length&&(K.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFBBFEBB"}})}),Ce.forEach(K=>{ye.forEach((J,ve)=>{const{currentValue:ze,previousValue:_e}=De(K,J,l,o),jt=ze-_e,Pe=Ge(ze,_e),{pbmdDisplayValue:Rt,adjDisplayValue:vt}=ot(K,J,d),at={part_no:ve===0?K.part_no:"",importer:ve===0?K.importer:"",category:ve===0?K.category:"",cost_item:J,prev:_e,pbmd:Rt,curr:ze,diff_amt:jt,diff_pct:Pe?`${Pe.toFixed(2)}%`:"-",adj:vt,remark:Je(K,J,d)};le.forEach(xe=>{at[xe]=Ue(K,J,xe,d)});const Pt=P.addRow(at),st=["Total Purchase Cost","Total Process Cost","Total Cost"].includes(J),Tt=st?"FFF9FACD":ve%2===0?"FFFAFAFA":"FFFFFFFF";Pt.eachCell((xe,We)=>{xe.fill={type:"pattern",pattern:"solid",fgColor:{argb:Tt}},xe.border={top:{style:"thin",color:{argb:"FFE5E7EB"}},bottom:{style:"thin",color:{argb:"FFE5E7EB"}},left:{style:"thin",color:{argb:"FFE5E7EB"}},right:{style:"thin",color:{argb:"FFE5E7EB"}}},st&&(xe.font={bold:!0}),We>=1&&We<=3&&(xe.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE8F1F7"}}),We===9&&Pe&&Math.abs(Pe)>15&&(xe.font={color:{argb:"FFDC2626"},bold:!0})})})});const G=await j.xlsx.writeBuffer(),_=new Blob([G],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),se=window.URL.createObjectURL(_),V=document.createElement("a");V.href=se,V.download="ppr_table.xlsx",V.click(),window.URL.revokeObjectURL(se)}p.useEffect(()=>{(async()=>{const P="/finance-dashboard/msp.json";try{const _=await(await fetch(P)).json();a(_.items||[]);const se=Array.from(new Set(_.items.map(V=>V.part_no)));g(se),B(Array.from(new Set(_.items.map(V=>V.importer)))),Y(Array.from(new Set(_.items.map(V=>V.category))))}catch(G){console.error("Failed to load msp.json:",G)}})()},[]);const A=p.useCallback(()=>{M(j=>!j),v(1)},[]),N=p.useCallback((j,P,G,_)=>{const se=Ze(j,P,G);c(V=>({...V,[se]:_})),x||te(!0)},[x]),D=p.useCallback((j,P)=>ot(j,P,d),[d,x,l,o]),I=p.useMemo(()=>{const j=new Set;return r.forEach(P=>{P.months&&Object.keys(P.months).forEach(G=>j.add(G))}),Array.from(j).sort().reverse()},[r]),W=p.useMemo(()=>{const j=new Set;return r.forEach(P=>{h.includes(P.part_no)&&E.includes(P.category)&&j.add(P.importer)}),Array.from(j)},[r,h,E]),Q=p.useMemo(()=>{const j=new Set;return r.forEach(P=>{h.includes(P.part_no)&&T.includes(P.importer)&&j.add(P.category)}),Array.from(j)},[r,h,T]),Ve=p.useMemo(()=>{const j=new Set;return r.forEach(P=>{T.includes(P.importer)&&E.includes(P.category)&&j.add(P.part_no)}),Array.from(j)},[r,T,E]),Ae=p.useMemo(()=>r.filter(j=>h.includes(j.part_no)&&T.includes(j.importer)&&E.includes(j.category)),[r,h,T,E]),et=p.useMemo(()=>{const j=new Set,P=[],G=new Set;for(const _ of Ae)G.has(_.part_no)||(P.push(_),G.add(_.part_no));return P.forEach(_=>{ye.forEach(se=>{const{currentValue:V,previousValue:K}=De(_,se,l,o),J=Ge(V,K);J&&Math.abs(J)>15&&j.add(_.part_no)})}),Array.from(j)},[Ae,l,o]),Ce=p.useMemo(()=>S?Ae.filter(j=>et.includes(j.part_no)):Ae,[Ae,S,et]),je=p.useMemo(()=>Array.from(new Set(Ce.map(j=>j.part_no))),[Ce]),tt=Math.ceil(je.length/w),Re=(F-1)*w,rt=je.slice(Re,Re+w),yt=p.useMemo(()=>Ce.filter(j=>rt.includes(j.part_no)),[Ce,rt]),bt=j=>{j>0&&j<=tt&&v(j)},St=p.useCallback(j=>{g(j),b(P=>({...P,partNo:!1})),v(1)},[]),Ot=p.useCallback(j=>{B(j),b(P=>({...P,importer:!1})),v(1)},[]),At=p.useCallback(j=>{Y(j),b(P=>({...P,category:!1})),v(1)},[]),Ct=p.useCallback(j=>{C(j)},[]),Nt=p.useCallback(j=>{b(P=>({...P,[j]:!P[j]}))},[]);return e.jsxs("div",{style:{background:"#fff",padding:"16px",position:"relative"},children:[e.jsx("button",{onClick:L,className:"btn",style:{position:"absolute",top:"16px",right:"16px",textDecoration:"none",color:"#000",fontSize:"16px",fontWeight:"bold",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",border:"none",background:"transparent",cursor:"pointer"},children:"X"}),e.jsx(Gt,{selectedPeriod:l,comparisonPeriod:o,availablePeriods:I,onPeriodChange:n,onComparisonPeriodChange:y,onDownload:q,isDirty:U,onSave:ae,isDphUser:x,onToggleNotices:()=>re(!0)}),e.jsx(Xt,{filteredMspData:yt,filterStates:f,toggleFilter:Nt,uniquePartNos:Ve,uniqueImporters:W,uniqueCategories:Q,filteredPartNos:h,filteredImporters:T,filteredCategories:E,onApplyFilter:St,onApplyImporterFilter:Ot,onApplyCategoryFilter:At,selectedPeriod:l,comparisonPeriod:o,calculateCostValues:De,calculateDiff:Ge,getDisplayValues:D,handleCellChange:N,analysisData:d,toggleThresholdFilter:A,thresholdActive:S,filteredCostItems:m,onApplyCostItemFilter:Ct}),e.jsx(Qe,{currentPage:F,totalPages:tt,goToPage:bt,totalRecords:je.length,startIndex:Re,endIndex:Re+w,itemsPerPage:w,onItemsPerPageChange:O}),e.jsx(tr,{isOpen:pe,onClose:()=>re(!1),isDphUser:x})]})}const gt=[{partNo:"51011-KK050",partName:"RAIL SUB-ASSY, FRAME SIDE, RH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"51012-KK050",partName:"RAIL SUB-ASSY, FRAME SIDE, LH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"51201-KK010",partName:"CROSSMEMBER SUB-ASSY, FRAME, NO.1",supplier:"TOYOTA MOTOR CORPORATION",category:"CHASSIS",status:"Active"},{partNo:"51205-KK010",partName:"AIR CLEANER ASSY",supplier:"DENSO CORPORATION",category:"ENGINE",status:"Active"},{partNo:"51206-KK020",partName:"CROSSMEMBER SUB-ASSY, FRAME, NO.6",supplier:"TOYOTA MOTOR CORPORATION",category:"CHASSIS",status:"Active"},{partNo:"51230-KK060",partName:"CROSSMEMBER ASSY, FRAME, NO.3",supplier:"TOYOTA MOTOR CORPORATION",category:"CHASSIS",status:"Active"},{partNo:"53301-0K150",partName:"HOOD SUB-ASSY",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"53801-0K080",partName:"FENDER SUB-ASSY, FR RH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"53802-0K080",partName:"FENDER SUB-ASSY, FR LH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"57403-KK010",partName:"MEMBER SUB-ASSY, FLOOR SIDE, INNER RR RH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"57404-KK010",partName:"MEMBER SUB-ASSY, FLOOR SIDE, INNER RR LH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"51204-KK070",partName:"CROSSMEMBER SUB-ASSY, FRAME, NO.4",supplier:"TOYOTA MOTOR CORPORATION",category:"CHASSIS",status:"Active"},{partNo:"480680D240",partName:"ARM SUB-ASSY, SUSPENSION LWR RH W/BUSH",supplier:"TOYOTA MOTOR CORPORATION",category:"SUSPENSION",status:"Active"},{partNo:"480690D240",partName:"ARM SUB-ASSY, SUSPENSION LWR LH W/BUSH",supplier:"TOYOTA MOTOR CORPORATION",category:"SUSPENSION",status:"Active"},{partNo:"51209KK010",partName:"CROSSMEMBER SUB-ASSY, FRAME, RR",supplier:"TOYOTA MOTOR CORPORATION",category:"CHASSIS",status:"Active"},{partNo:"51230KK070",partName:"CROSSMEMBER ASSY, FRAME, NO.3",supplier:"TOYOTA MOTOR CORPORATION",category:"CHASSIS",status:"Active"},{partNo:"55101KK010",partName:"PANEL SUB-ASSY, DASH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"57401KK010",partName:"MEMBER SUB-ASSY, FLOOR SIDE, INNER RH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"57402KK010",partName:"MEMBER SUB-ASSY, FLOOR SIDE, INNER LH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"610330K050",partName:"REINFORCE SUB-ASSY, BACK DOOR OPG SI, RH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"610340K050",partName:"REINFORCE SUB-ASSY, BACK DOOR OPG SI, LH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"617050K100",partName:"FRAME SUB-ASSY, BACK DOOR OPG SI, RH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"617060K100",partName:"FRAME SUB-ASSY, BACK DOOR OPG SI, LH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"480680K100",partName:"ARM SUB-ASSY, SUSPENSION LWR RH W/BUSH",supplier:"TOYOTA MOTOR CORPORATION",category:"SUSPENSION",status:"Active"},{partNo:"480690K100",partName:"ARM SUB-ASSY, SUSPENSION LWR LH W/BUSH",supplier:"TOYOTA MOTOR CORPORATION",category:"SUSPENSION",status:"Active"},{partNo:"486100K100",partName:"ARM ASSY, SUSPENSION, UPR RH",supplier:"TOYOTA MOTOR CORPORATION",category:"SUSPENSION",status:"Active"},{partNo:"486300K100",partName:"ARM ASSY, SUSPENSION, UPR LH",supplier:"TOYOTA MOTOR CORPORATION",category:"SUSPENSION",status:"Active"},{partNo:"51011KK040",partName:"RAIL SUB-ASSY, FRAME SIDE, RH",supplier:"TOYOTA MOTOR CORPORATION",category:"CHASSIS",status:"Active"},{partNo:"51012KK040",partName:"RAIL SUB-ASSY, FRAME SIDE, LH",supplier:"TOYOTA MOTOR CORPORATION",category:"CHASSIS",status:"Active"},{partNo:"51201KK020",partName:"CROSSMEMBER SUB-ASSY, FRAME, NO.1",supplier:"TOYOTA MOTOR CORPORATION",category:"CHASSIS",status:"Active"},{partNo:"51202KK010",partName:"CROSSMEMBER SUB-ASSY, FRAME, NO.2",supplier:"TOYOTA MOTOR CORPORATION",category:"CHASSIS",status:"Active"},{partNo:"51204KK060",partName:"CROSSMEMBER SUB-ASSY, FRAME, NO.4",supplier:"TOYOTA MOTOR CORPORATION",category:"CHASSIS",status:"Active"},{partNo:"51204KK080",partName:"CROSSMEMBER SUB-ASSY, FRAME, NO.4",supplier:"TOYOTA MOTOR CORPORATION",category:"CHASSIS",status:"Active"},{partNo:"51205KK050",partName:"CROSSMEMBER SUB-ASSY, FRAME, NO.5",supplier:"TOYOTA MOTOR CORPORATION",category:"CHASSIS",status:"Active"},{partNo:"51230KK010",partName:"CROSSMEMBER ASSY, FRAME, NO.3",supplier:"TOYOTA MOTOR CORPORATION",category:"CHASSIS",status:"Active"},{partNo:"51230KK040",partName:"CROSSMEMBER ASSY, FRAME, NO.3",supplier:"TOYOTA MOTOR CORPORATION",category:"CHASSIS",status:"Active"},{partNo:"53301KK031",partName:"HOOD SUB-ASSY",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"53801KK020",partName:"FENDER SUB-ASSY, FR RH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"53802KK020",partName:"FENDER SUB-ASSY, FR LH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"61705KK010",partName:"FRAME SUB-ASSY, BACK DOOR OPG SI, RH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"61706KK011",partName:"FRAME SUB-ASSY, BACK DOOR OPG SI, LH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"67001KK010",partName:"PANEL SUB-ASSY, FR DOOR, RH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"67002KK010",partName:"PANEL SUB-ASSY, FR DOOR, LH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"67003KK030",partName:"PANEL SUB-ASSY, RR DOOR, RH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"67004KK030",partName:"PANEL SUB-ASSY, RR DOOR, LH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"67005KK010",partName:"PANEL SUB-ASSY, BACK DOOR",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"67005KK070",partName:"PANEL SUB-ASSY, BACK DOOR",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"432100KB82",partName:"KNUCKLE ASSY, STEERING RH W/DISC BRAKE",supplier:"TOYOTA MOTOR CORPORATION",category:"STEERING",status:"Active"},{partNo:"432100KB92",partName:"KNUCKLE ASSY, STEERING RH W/DISC BRAKE",supplier:"TOYOTA MOTOR CORPORATION",category:"STEERING",status:"Active"},{partNo:"432200KB82",partName:"KNUCKLE ASSY, STEERING LH W/DISC BRAKE",supplier:"TOYOTA MOTOR CORPORATION",category:"STEERING",status:"Active"},{partNo:"432200KB92",partName:"KNUCKLE ASSY, STEERING LH W/DISC BRAKE",supplier:"TOYOTA MOTOR CORPORATION",category:"STEERING",status:"Active"},{partNo:"43210BZ061",partName:"KNUCKLE ASSY, STEERING RH W/DISC BRAKE",supplier:"TOYOTA MOTOR CORPORATION",category:"STEERING",status:"Active"},{partNo:"43220BZ061",partName:"KNUCKLE ASSY, STEERING LH W/DISC BRAKE",supplier:"TOYOTA MOTOR CORPORATION",category:"STEERING",status:"Active"},{partNo:"57101BZ690",partName:"MEMBER SUB-ASSY, FR SIDE, RH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"57102BZ770",partName:"MEMBER SUB-ASSY, FR SIDE, LH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"57402BZ491",partName:"MEMBER SUB-ASSY, FLOOR SIDE, INNER RH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"57607BZ100",partName:"MEMBER SUB-ASSY, RR FLOOR CROSS, NO.3",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"53301BZ420",partName:"HOOD SUB-ASSY",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"57401BZ491",partName:"MEMBER SUB-ASSY, FLOOR SIDE, INNER LH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"57401BZ901",partName:"MEMBER S/A, FLOOR SIDE, INN RH W/O R/F",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"57605BZ210",partName:"MEMBER SUB-ASSY, RR FLOOR CROSS, NO.1",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"67001BZ710",partName:"PANEL SUB-ASSY, FR DOOR, RH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"67002BZ710",partName:"PANEL SUB-ASSY, FR DOOR, LH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"67003BZ720",partName:"PANEL SUB-ASSY, RR DOOR, RH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"67003BZ740",partName:"PANEL SUB-ASSY, RR DOOR, RH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"67004BZ720",partName:"PANEL SUB-ASSY, RR DOOR, LH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"67004BZ740",partName:"PANEL SUB-ASSY, RR DOOR, LH",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"67005BZB80",partName:"PANEL SUB-ASSY, BACK DOOR",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"67005BZG60",partName:"PANEL SUB-ASSY, BACK DOOR",supplier:"TOYOTA MOTOR CORPORATION",category:"BODY",status:"Active"},{partNo:"CMD-001",partName:"RAIL ASSEMBLY RIGHT SIDE",supplier:"CMD SYSTEM",category:"BODY",status:"Active"},{partNo:"CMD-002",partName:"RAIL ASSEMBLY LEFT SIDE",supplier:"CMD SYSTEM",category:"BODY",status:"Active"},{partNo:"CMD-007",partName:"HOOD ASSEMBLY",supplier:"CMD SYSTEM",category:"BODY",status:"Active"},{partNo:"SAP-A001",partName:"FRAME CROSSMEMBER TYPE A",supplier:"SAP SYSTEM",category:"CHASSIS",status:"Active"},{partNo:"IFAST-B123",partName:"AIR FILTER ASSEMBLY",supplier:"IFAST SYSTEM",category:"ENGINE",status:"Active"}],ar=t=>gt.find(r=>r.partNo===t),it=t=>gt.some(r=>r.partNo===t),Be=t=>{const r=ar(t);return r?r.partName:""},Xe=[{id:1,leftPart:"51011-KK050",leftPartName:"RAIL SUB-ASSY, FRAME SIDE, RH",rightPart:"CMD-001",rightPartName:"RAIL ASSEMBLY RIGHT SIDE",status:"Active",createdDate:"2025-10-20",lastModified:"2025-10-22"},{id:2,leftPart:"51012-KK050",leftPartName:"RAIL SUB-ASSY, FRAME SIDE, LH",rightPart:"CMD-002",rightPartName:"RAIL ASSEMBLY LEFT SIDE",status:"Active",createdDate:"2025-10-20",lastModified:"2025-10-22"},{id:3,leftPart:"51201-KK010",leftPartName:"CROSSMEMBER SUB-ASSY, FRAME, NO.1",rightPart:"SAP-A001",rightPartName:"FRAME CROSSMEMBER TYPE A",status:"Active",createdDate:"2025-10-19",lastModified:"2025-10-21"},{id:4,leftPart:"51205-KK010",leftPartName:"AIR CLEANER ASSY",rightPart:"IFAST-B123",rightPartName:"AIR FILTER ASSEMBLY",status:"Active",createdDate:"2025-10-18",lastModified:"2025-10-20"},{id:5,leftPart:"51206-KK020",leftPartName:"CROSSMEMBER SUB-ASSY, FRAME, NO.6",rightPart:"",rightPartName:"",status:"Pending",createdDate:"2025-10-22",lastModified:"2025-10-22"},{id:6,leftPart:"51230-KK060",leftPartName:"CROSSMEMBER ASSY, FRAME, NO.3",rightPart:"",rightPartName:"",status:"Pending",createdDate:"2025-10-22",lastModified:"2025-10-22"},{id:7,leftPart:"53301-0K150",leftPartName:"HOOD SUB-ASSY",rightPart:"CMD-007",rightPartName:"HOOD ASSEMBLY",status:"Active",createdDate:"2025-10-17",lastModified:"2025-10-19"},{id:8,leftPart:"53801-0K080",leftPartName:"FENDER SUB-ASSY, FR RH",rightPart:"",rightPartName:"",status:"Pending",createdDate:"2025-10-22",lastModified:"2025-10-22"}],sr=(t,r=null)=>Xe.some(a=>a.id!==r&&a.leftPart===t),lr=(t,r=null)=>Xe.some(a=>a.id!==r&&a.rightPart===t);function or(){const t=be(),[r,a]=p.useState([...Xe]),[s,i]=p.useState(null),[l,n]=p.useState(""),[o,y]=p.useState(""),[d,c]=p.useState(""),[f,b]=p.useState(""),[h,g]=p.useState({}),T=(m,C,F=null)=>{const v={};return m&&!it(m)&&(v.leftPart=`Part number "${m}" not found in master data`),C&&!it(C)&&(v.rightPart=`Part number "${C}" not found in master data`),m&&sr(m,F)&&(v.leftPart=`Part number "${m}" is already used as LEFT part in another pairing`),C&&lr(C,F)&&(v.rightPart=`Part number "${C}" is already used as RIGHT part in another pairing`),v},B=(m,C,F,v,S)=>{i(m),n(C),y(F),c(v),b(S),g({})},E=m=>{const C=T(l,d,m);if(Object.keys(C).length>0){g(C);return}const F=o||Be(l),v=f||Be(d);a(r.map(S=>S.id===m?{...S,leftPart:l,leftPartName:F,rightPart:d,rightPartName:v,status:l&&d?"Active":"Pending",lastModified:new Date().toISOString().split("T")[0]}:S)),i(null),n(""),y(""),c(""),b(""),g({})},Y=()=>{i(null),n(""),y(""),c(""),b(""),g({})},k=()=>{if(s!==null){alert("Please save or cancel the current edit before adding a new record.");return}const m=Math.max(...r.map(F=>F.id))+1,C={id:m,leftPart:"",leftPartName:"",rightPart:"",rightPartName:"",status:"Pending",createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0]};a([C,...r]),i(m),n(""),y(""),c(""),b(""),g({})},u=m=>{window.confirm("Are you sure you want to delete this pairing?")&&a(r.filter(C=>C.id!==m))};return e.jsx("div",{style:{padding:20},children:e.jsxs("div",{style:{maxWidth:1200,margin:"0 auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[e.jsxs("div",{children:[e.jsx("h1",{style:{margin:0,fontSize:28,fontWeight:600},children:"Part Pairing Management"}),e.jsx("p",{style:{margin:"6px 0 0",color:"#6b7280",fontSize:14},children:"Manage part number mappings between different systems (CMD, SAP, IFAST)"})]}),e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("button",{onClick:k,disabled:s!==null,className:"btn btn-ghost",style:{opacity:s!==null?.5:1,cursor:s!==null?"not-allowed":"pointer"},title:s!==null?"Save or cancel current edit before adding new record":"Add new part pairing",children:"+ Add New"}),e.jsx("button",{className:"btn btn-ghost",onClick:()=>t(-1),children:"← Back"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>alert("Save changes (preview)"),children:"Save Changes"})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:16,marginBottom:24},children:[e.jsxs("div",{style:nt,children:[e.jsx("div",{style:dt,children:r.filter(m=>m.status==="Active").length}),e.jsx("div",{style:ct,children:"Active Pairings"})]}),e.jsxs("div",{style:nt,children:[e.jsx("div",{style:dt,children:r.length}),e.jsx("div",{style:ct,children:"Total Parts"})]})]}),e.jsx("div",{style:{border:"1px solid rgba(0,0,0,0.1)",borderRadius:8,overflow:"hidden",backgroundColor:"white"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f8f9fa"},children:[e.jsx("th",{style:we,children:"Rec No"}),e.jsx("th",{style:we,children:"LEFT Part"}),e.jsx("th",{style:we,children:"RIGHT Part"}),e.jsx("th",{style:we,children:"Actions"})]})}),e.jsx("tbody",{children:r.map((m,C)=>e.jsxs("tr",{style:{borderBottom:"1px solid rgba(0,0,0,0.05)"},children:[e.jsx("td",{style:ke,children:e.jsx("div",{style:{fontWeight:500,fontSize:13,color:"#374151",textAlign:"center"},children:C+1})}),e.jsx("td",{style:ke,children:s===m.id?e.jsxs("div",{children:[e.jsx("input",{type:"text",value:l,onChange:F=>{n(F.target.value);const v=Be(F.target.value);v&&y(v),h.leftPart&&g(S=>({...S,leftPart:null}))},style:{width:"100%",padding:"4px 6px",border:h.leftPart?"1px solid #ef4444":"1px solid #007bff",borderRadius:4,fontFamily:"monospace",fontSize:12,marginBottom:4},placeholder:"Part Number"}),h.leftPart&&e.jsx("div",{style:{color:"#ef4444",fontSize:10,marginBottom:4,lineHeight:1.2},children:h.leftPart}),e.jsx("input",{type:"text",value:o,readOnly:!0,tabIndex:"-1",style:{width:"100%",padding:"4px 6px",border:"1px solid #d1d5db",borderRadius:4,fontSize:11,backgroundColor:"#f9fafb",color:"#6b7280"},placeholder:"Part Name (auto-filled)"})]}):e.jsxs("div",{children:[e.jsx("div",{style:{fontFamily:"monospace",fontWeight:500,fontSize:13},children:m.leftPart}),e.jsx("div",{style:{fontSize:11,color:"#6b7280",marginTop:2},children:m.leftPartName})]})}),e.jsx("td",{style:ke,children:s===m.id?e.jsxs("div",{children:[e.jsx("input",{type:"text",value:d,onChange:F=>{c(F.target.value);const v=Be(F.target.value);v&&b(v),h.rightPart&&g(S=>({...S,rightPart:null}))},style:{width:"100%",padding:"4px 6px",border:h.rightPart?"1px solid #ef4444":"1px solid #007bff",borderRadius:4,fontFamily:"monospace",fontSize:12,marginBottom:4},placeholder:"Part Number"}),h.rightPart&&e.jsx("div",{style:{color:"#ef4444",fontSize:10,marginBottom:4,lineHeight:1.2},children:h.rightPart}),e.jsx("input",{type:"text",value:f,readOnly:!0,tabIndex:"-1",style:{width:"100%",padding:"4px 6px",border:"1px solid #d1d5db",borderRadius:4,fontSize:11,backgroundColor:"#f9fafb",color:"#6b7280"},placeholder:"Part Name (auto-filled)"})]}):e.jsxs("div",{children:[e.jsx("div",{style:{fontFamily:"monospace",fontWeight:500,fontSize:13,color:m.rightPart?"#000":"#999"},children:m.rightPart||"Not assigned"}),e.jsx("div",{style:{fontSize:11,color:"#6b7280",marginTop:2},children:m.rightPartName||(m.rightPart?"Unknown part name":"Not assigned")})]})}),e.jsx("td",{style:ke,children:e.jsx("div",{style:{display:"flex",gap:4},children:s===m.id?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>E(m.id),style:Ye("#10b981"),children:"Save"}),e.jsx("button",{onClick:Y,style:Ye("#6b7280"),children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>B(m.id,m.leftPart,m.leftPartName,m.rightPart,m.rightPartName),style:Ye("#3b82f6"),children:"Edit"}),e.jsx("button",{onClick:()=>u(m.id),style:Ye("#ef4444"),children:"Delete"})]})})})]},m.id))})]})}),e.jsxs("div",{style:{marginTop:16,display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:13,color:"#6b7280"},children:[e.jsxs("div",{children:["Showing ",r.length," part pairings"]}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{className:"btn btn-ghost",onClick:()=>alert("Export (preview)"),children:"Export"}),e.jsx("button",{className:"btn btn-ghost",onClick:()=>alert("Import (preview)"),children:"Import"})]})]})]})})}const nt={padding:16,backgroundColor:"white",border:"1px solid rgba(0,0,0,0.1)",borderRadius:8,textAlign:"center"},dt={fontSize:24,fontWeight:600,color:"#1f2937"},ct={fontSize:12,color:"#6b7280",marginTop:4},we={padding:"12px 16px",textAlign:"left",fontSize:12,fontWeight:600,color:"#374151",borderBottom:"1px solid rgba(0,0,0,0.1)"},ke={padding:"12px 16px",fontSize:13,color:"#1f2937"},Ye=t=>({padding:"4px 8px",fontSize:11,border:`1px solid ${t}`,borderRadius:4,backgroundColor:"white",color:t,cursor:"pointer"}),pt={"Aug-25":[{no:1,partNo:"51011-KK050",partName:"RAIL SUB-ASSY, FRAME SIDE, RH",localOH:"",localOHPrev:"",toolingOH:333.082,toolingOHPrev:288.52,rawMaterial:82,rawMaterialPrev:75.5,labor:784.238,laborPrev:720.8,fohFix:214.761,fohFixPrev:198.2,fohVar:120.351,fohVarPrev:110.9,unfinishDepre:41.853,unfinishDeprePrev:38.6,totalProcessCost:94.069,exclusiveInvestment:27.474,prevPeriod:1373.273,totalCost:1615.909,diff:17.66,remark:"RH - LH different",plant:"4350"},{no:2,partNo:"51012-KK050",partName:"RAIL SUB-ASSY, FRAME SIDE, LH",localOH:"",localOHPrev:"",toolingOH:342.265,toolingOHPrev:312.45,rawMaterial:567,rawMaterialPrev:522.1,labor:784.238,laborPrev:722.5,fohFix:213.569,fohFixPrev:196.8,fohVar:120.351,fohVarPrev:111,unfinishDepre:41.853,unfinishDeprePrev:38.5,totalProcessCost:94.069,exclusiveInvestment:27.474,prevPeriod:1900.53,totalCost:1624.385,diff:-14.53,remark:"",plant:"4350"},{no:3,partNo:"51201-KK010",partName:"CROSSMEMBER SUB-ASSY, FRAME, NO.1",localOH:"164.125",localOHPrev:"148.750",toolingOH:6.442,toolingOHPrev:5.89,rawMaterial:113.594,rawMaterialPrev:104.8,labor:75.767,laborPrev:69.9,fohFix:213.129,fohFixPrev:196.5,fohVar:80.827,fohVarPrev:74.6,unfinishDepre:184.761,unfinishDeprePrev:170.4,totalProcessCost:554.483,exclusiveInvestment:8.69,prevPeriod:778.41,totalCost:864.932,diff:11.12,remark:"",plant:"4360"},{no:4,partNo:"51205-KK010",partName:"AIR CLEANER ASSY",localOH:"98.342",localOHPrev:"89.420",toolingOH:1.256,toolingOHPrev:1.18,rawMaterial:69.773,rawMaterialPrev:64.4,labor:15.289,laborPrev:14.1,fohFix:9.018,fohFixPrev:8.3,fohVar:2.091,fohVarPrev:1.9,unfinishDepre:3.245,unfinishDeprePrev:3,totalProcessCost:29.643,exclusiveInvestment:2.04,prevPeriod:170.551,totalCost:155.047,diff:-9.1,remark:"",plant:"4350"},{no:5,partNo:"51206-KK020",partName:"CROSSMEMBER SUB-ASSY, FRAME, NO.6",localOH:"279.435",localOHPrev:"251.490",toolingOH:7.689,toolingOHPrev:7.12,rawMaterial:0,rawMaterialPrev:0,labor:51.919,laborPrev:47.9,fohFix:15.604,fohFixPrev:14.4,fohVar:6.074,fohVarPrev:5.6,unfinishDepre:13.963,unfinishDeprePrev:12.9,totalProcessCost:87.56,exclusiveInvestment:4.728,prevPeriod:341.272,totalCost:379.413,diff:11.18,remark:"",plant:"4350"},{no:6,partNo:"51230-KK060",partName:"CROSSMEMBER ASSY, FRAME, NO.3",localOH:"320.749",localOHPrev:"295.680",toolingOH:2.792,toolingOHPrev:2.59,rawMaterial:0,rawMaterialPrev:0,labor:61.617,laborPrev:56.8,fohFix:9.984,fohFixPrev:9.2,fohVar:3.886,fohVarPrev:3.6,unfinishDepre:8.933,unfinishDeprePrev:8.2,totalProcessCost:84.42,exclusiveInvestment:5.195,prevPeriod:454.471,totalCost:413.155,diff:-9.1,remark:"",plant:"4350"},{no:7,partNo:"53301-0K150",partName:"HOOD SUB-ASSY",localOH:"98.27",toolingOH:3.541,rawMaterial:342.302,rawMaterialPrev:315.8,labor:25.025,laborPrev:23.1,fohFix:12.16,fohFixPrev:11.2,fohVar:10.429,fohVarPrev:9.6,unfinishDepre:13.26,unfinishDeprePrev:12.2,totalProcessCost:60.873,exclusiveInvestment:19.487,prevPeriod:446.025,totalCost:524.472,diff:17.58,remark:"",plant:"4360"},{no:8,partNo:"53801-0K080",partName:"FENDER SUB-ASSY, FR RH",localOH:"7.6",toolingOH:0,rawMaterial:130.78,rawMaterialPrev:120.7,labor:18.909,laborPrev:17.4,fohFix:6.325,fohFixPrev:5.8,fohVar:5.492,fohVarPrev:5.1,unfinishDepre:7.399,unfinishDeprePrev:6.8,totalProcessCost:38.125,exclusiveInvestment:63.094,prevPeriod:263.659,totalCost:239.599,diff:-9.13,remark:"",plant:"4360"},{no:9,partNo:"53802-0K080",partName:"FENDER SUB-ASSY, FR LH",localOH:"7.6",toolingOH:0,rawMaterial:130.78,rawMaterialPrev:120.7,labor:18.792,laborPrev:17.3,fohFix:6.358,fohFixPrev:5.9,fohVar:5.492,fohVarPrev:5.1,unfinishDepre:7.399,unfinishDeprePrev:6.8,totalProcessCost:38.041,exclusiveInvestment:63.094,prevPeriod:203.612,totalCost:239.515,diff:17.64,remark:"",plant:"4360"},{no:10,partNo:"57403-KK010",partName:"MEMBER SUB-ASSY, FLOOR SIDE, INNER RR RH",localOH:"12.02",toolingOH:0,rawMaterial:85.187,rawMaterialPrev:78.6,labor:10.854,laborPrev:10,fohFix:6.9,fohFixPrev:6.4,fohVar:3.027,fohVarPrev:2.8,unfinishDepre:1.307,unfinishDeprePrev:1.2,totalProcessCost:22.088,exclusiveInvestment:3.739,prevPeriod:135.337,totalCost:123.034,diff:-9.1,remark:"",plant:"4350"},{no:11,partNo:"57404-KK010",partName:"MEMBER SUB-ASSY, FLOOR SIDE, INNER RR LH",localOH:"12.2",toolingOH:0,rawMaterial:85.187,rawMaterialPrev:78.6,labor:10.854,laborPrev:10,fohFix:6.9,fohFixPrev:6.4,fohVar:3.027,fohVarPrev:2.8,unfinishDepre:1.307,unfinishDeprePrev:1.2,totalProcessCost:22.088,exclusiveInvestment:3.739,prevPeriod:104.732,totalCost:123.214,diff:17.65,remark:"",plant:"4350"},{no:12,partNo:"51204-KK070",partName:"CROSSMEMBER SUB-ASSY, FRAME, NO.4",localOH:"240.051",toolingOH:4.047,rawMaterial:0,rawMaterialPrev:0,labor:29.459,laborPrev:27.2,fohFix:10.03,fohFixPrev:9.3,fohVar:3.904,fohVarPrev:3.6,unfinishDepre:8.975,unfinishDeprePrev:8.3,totalProcessCost:52.368,exclusiveInvestment:4.076,prevPeriod:331.313,totalCost:301.194,diff:-9.1,remark:"",plant:""}],"Jul-25":[{no:1,partNo:"51011-KK050",partName:"RAIL SUB-ASSY, FRAME SIDE, RH",localOH:"",toolingOH:325.445,rawMaterial:79,labor:760.125,fohFix:208.392,fohVar:116.741,unfinishDepre:40.58,totalProcessCost:91.306,exclusiveInvestment:26.64,prevPeriod:1334.156,totalCost:1569.595,diff:15.43,remark:"RH - LH different",plant:"4350"},{no:2,partNo:"51012-KK050",partName:"RAIL SUB-ASSY, FRAME SIDE, LH",localOH:"",toolingOH:334.102,rawMaterial:550,labor:760.125,fohFix:207.263,fohVar:116.741,unfinishDepre:40.58,totalProcessCost:91.306,exclusiveInvestment:26.64,prevPeriod:1842.515,totalCost:1574.967,diff:-14.53,remark:"",plant:"4350"},{no:3,partNo:"51201-KK010",partName:"CROSSMEMBER SUB-ASSY, FRAME, NO.1",localOH:"159.801",toolingOH:6.262,rawMaterial:110.398,labor:73.645,fohFix:207.255,fohVar:78.603,unfinishDepre:179.621,totalProcessCost:539.269,exclusiveInvestment:8.456,prevPeriod:756.929,totalCost:841.027,diff:11.12,remark:"",plant:"4360"},{no:4,partNo:"51205-KK010",partName:"AIR CLEANER ASSY",localOH:"95.653",toolingOH:1.221,rawMaterial:67.832,labor:14.831,fohFix:8.767,fohVar:2.033,unfinishDepre:3.154,totalProcessCost:28.785,exclusiveInvestment:1.983,prevPeriod:165.836,totalCost:150.76,diff:-9.1,remark:"",plant:"4350"},{no:5,partNo:"51206-KK020",partName:"CROSSMEMBER SUB-ASSY, FRAME, NO.6",localOH:"271.694",toolingOH:7.481,rawMaterial:0,labor:50.484,fohFix:15.187,fohVar:5.912,unfinishDepre:13.581,totalProcessCost:85.164,exclusiveInvestment:4.599,prevPeriod:331.837,totalCost:368.708,diff:11.18,remark:"",plant:"4350"},{no:6,partNo:"51230-KK060",partName:"CROSSMEMBER ASSY, FRAME, NO.3",localOH:"312.129",toolingOH:2.716,rawMaterial:0,labor:59.97,fohFix:9.713,fohVar:3.781,unfinishDepre:8.695,totalProcessCost:82.159,exclusiveInvestment:5.054,prevPeriod:442.259,totalCost:401.854,diff:-9.1,remark:"",plant:"4350"},{no:7,partNo:"53301-0K150",partName:"HOOD SUB-ASSY",localOH:"95.582",toolingOH:3.445,rawMaterial:332.814,labor:24.374,fohFix:11.836,fohVar:10.157,unfinishDepre:12.903,totalProcessCost:59.27,exclusiveInvestment:18.964,prevPeriod:434.024,totalCost:510.445,diff:17.58,remark:"",plant:"4360"},{no:8,partNo:"53801-0K080",partName:"FENDER SUB-ASSY, FR RH",localOH:"7.4",toolingOH:0,rawMaterial:127.259,labor:18.404,fohFix:6.156,fohVar:5.343,unfinishDepre:7.198,totalProcessCost:37.101,exclusiveInvestment:61.391,prevPeriod:256.612,totalCost:233.285,diff:-9.13,remark:"",plant:"4360"},{no:9,partNo:"53802-0K080",partName:"FENDER SUB-ASSY, FR LH",localOH:"7.4",toolingOH:0,rawMaterial:127.259,labor:18.291,fohFix:6.188,fohVar:5.343,unfinishDepre:7.198,totalProcessCost:37.02,exclusiveInvestment:61.391,prevPeriod:198.311,totalCost:233.201,diff:17.64,remark:"",plant:"4360"},{no:10,partNo:"57403-KK010",partName:"MEMBER SUB-ASSY, FLOOR SIDE, INNER RR RH",localOH:"11.70",toolingOH:0,rawMaterial:82.832,labor:10.572,fohFix:6.717,fohVar:2.945,unfinishDepre:1.273,totalProcessCost:21.507,exclusiveInvestment:3.64,prevPeriod:131.778,totalCost:119.798,diff:-9.1,remark:"",plant:"4350"},{no:11,partNo:"57404-KK010",partName:"MEMBER SUB-ASSY, FLOOR SIDE, INNER RR LH",localOH:"11.87",toolingOH:0,rawMaterial:82.832,labor:10.572,fohFix:6.717,fohVar:2.945,unfinishDepre:1.273,totalProcessCost:21.507,exclusiveInvestment:3.64,prevPeriod:101.935,totalCost:119.879,diff:17.65,remark:"",plant:"4350"},{no:12,partNo:"51204-KK070",partName:"CROSSMEMBER SUB-ASSY, FRAME, NO.4",localOH:"233.450",toolingOH:3.936,rawMaterial:0,labor:28.677,fohFix:9.759,fohVar:3.801,unfinishDepre:8.734,totalProcessCost:50.971,exclusiveInvestment:3.966,prevPeriod:322.383,totalCost:292.984,diff:-9.1,remark:"",plant:""}],"Jun-25":[{no:1,partNo:"51011-KK050",partName:"RAIL SUB-ASSY, FRAME SIDE, RH",localOH:"",toolingOH:318.234,rawMaterial:76,labor:742.89,fohFix:203.156,fohVar:113.925,unfinishDepre:39.612,totalProcessCost:89.145,exclusiveInvestment:26.001,prevPeriod:1298.923,totalCost:1527.556,diff:13.89,remark:"RH - LH different",plant:"4350"},{no:2,partNo:"51012-KK050",partName:"RAIL SUB-ASSY, FRAME SIDE, LH",localOH:"",toolingOH:326.542,rawMaterial:535,labor:742.89,fohFix:202.098,fohVar:113.925,unfinishDepre:39.612,totalProcessCost:89.145,exclusiveInvestment:26.001,prevPeriod:1797.015,totalCost:1536.434,diff:-14.53,remark:"",plant:"4350"},{no:3,partNo:"51201-KK010",partName:"CROSSMEMBER SUB-ASSY, FRAME, NO.1",localOH:"156.240",toolingOH:6.12,rawMaterial:107.882,labor:71.982,fohFix:202.535,fohVar:76.784,unfinishDepre:175.603,totalProcessCost:526.904,exclusiveInvestment:8.265,prevPeriod:739.291,totalCost:821.434,diff:11.12,remark:"",plant:"4360"},{no:4,partNo:"51205-KK010",partName:"AIR CLEANER ASSY",localOH:"93.505",toolingOH:1.193,rawMaterial:66.286,labor:14.508,fohFix:8.567,fohVar:1.988,unfinishDepre:3.085,totalProcessCost:28.148,exclusiveInvestment:1.939,prevPeriod:162.14,totalCost:147.4,diff:-9.1,remark:"",plant:"4350"},{no:5,partNo:"51206-KK020",partName:"CROSSMEMBER SUB-ASSY, FRAME, NO.6",localOH:"265.555",toolingOH:7.313,rawMaterial:0,labor:49.374,fohFix:14.834,fohVar:5.776,unfinishDepre:13.273,totalProcessCost:83.257,exclusiveInvestment:4.495,prevPeriod:324.239,totalCost:360.265,diff:11.18,remark:"",plant:"4350"},{no:6,partNo:"51230-KK060",partName:"CROSSMEMBER ASSY, FRAME, NO.3",localOH:"304.931",toolingOH:2.655,rawMaterial:0,labor:58.645,fohFix:9.495,fohVar:3.696,unfinishDepre:8.5,totalProcessCost:80.336,exclusiveInvestment:4.943,prevPeriod:432.427,totalCost:393.115,diff:-9.1,remark:"",plant:"4350"},{no:7,partNo:"53301-0K150",partName:"HOOD SUB-ASSY",localOH:"93.475",toolingOH:3.369,rawMaterial:325.374,labor:23.844,fohFix:11.576,fohVar:9.932,unfinishDepre:12.618,totalProcessCost:57.97,exclusiveInvestment:18.548,prevPeriod:424.371,totalCost:499.26,diff:17.58,remark:"",plant:"4360"},{no:8,partNo:"53801-0K080",partName:"FENDER SUB-ASSY, FR RH",localOH:"7.22",toolingOH:0,rawMaterial:124.422,labor:17.998,fohFix:6.021,fohVar:5.225,unfinishDepre:7.04,totalProcessCost:36.284,exclusiveInvestment:60.055,prevPeriod:251.155,totalCost:228.323,diff:-9.13,remark:"",plant:"4360"},{no:9,partNo:"53802-0K080",partName:"FENDER SUB-ASSY, FR LH",localOH:"7.22",toolingOH:0,rawMaterial:124.422,labor:17.889,fohFix:6.053,fohVar:5.225,unfinishDepre:7.04,totalProcessCost:36.207,exclusiveInvestment:60.055,prevPeriod:193.995,totalCost:228.246,diff:17.64,remark:"",plant:"4360"},{no:10,partNo:"57403-KK010",partName:"MEMBER SUB-ASSY, FLOOR SIDE, INNER RR RH",localOH:"11.43",toolingOH:0,rawMaterial:81.023,labor:10.337,fohFix:6.567,fohVar:2.88,unfinishDepre:1.245,totalProcessCost:21.029,exclusiveInvestment:3.558,prevPeriod:128.826,totalCost:117.115,diff:-9.1,remark:"",plant:"4350"},{no:11,partNo:"57404-KK010",partName:"MEMBER SUB-ASSY, FLOOR SIDE, INNER RR LH",localOH:"11.60",toolingOH:0,rawMaterial:81.023,labor:10.337,fohFix:6.567,fohVar:2.88,unfinishDepre:1.245,totalProcessCost:21.029,exclusiveInvestment:3.558,prevPeriod:99.614,totalCost:117.194,diff:17.65,remark:"",plant:"4350"},{no:12,partNo:"51204-KK070",partName:"CROSSMEMBER SUB-ASSY, FRAME, NO.4",localOH:"228.249",toolingOH:3.848,rawMaterial:0,labor:28.037,fohFix:9.54,fohVar:3.717,unfinishDepre:8.544,totalProcessCost:49.838,exclusiveInvestment:3.878,prevPeriod:315.169,totalCost:286.517,diff:-9.1,remark:"",plant:""}]},z=t=>t==null?0:typeof t=="number"?t:typeof t=="string"?t.trim()===""?0:parseFloat(t.replace(/,/g,""))||0:0,Z=t=>t==null||t===""?"-":typeof t=="number"?t.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):t,Se=t=>{if(t==null||t==="")return"-";if(typeof t=="number"){const r=t.toFixed(2);return t>=0?`+${r}%`:`${r}%`}return t},ee=(t,r)=>{if(t==null||r==null||r===0)return null;const a=typeof t=="string"?parseFloat(t.replace(/,/g,"")):t,s=typeof r=="string"?parseFloat(r.replace(/,/g,"")):r;return isNaN(a)||isNaN(s)||s===0?null:(a-s)/s*100},ir=()=>{const[t,r]=p.useState([]),[a,s]=p.useState(""),[i,l]=p.useState("");return{rows:t,comparedMonth1:a,comparedMonth2:i,handleCompare:(o,y)=>{const d=pt[o],f=pt[y].map((b,h)=>{const g=d.find(O=>O.partNo===b.partNo);if(!g)return{...b,no:h+1,prevPeriod:0,diff:100,localOHPrev:0,toolingOHPrev:0,rawMaterialPrev:0,laborPrev:0,fohFixPrev:0,fohVarPrev:0,unfinishDeprePrev:0,fgCostPrev:0,mfgCostPrev:0,sellingPricePrev:0,totalCostPrev:0,totalProcessCost:0,totalProcessCostPrev:0,exclusiveInvestment:0,exclusiveInvestmentPrev:0};const T=z(b.labor),B=z(b.fohFix),E=z(b.fohVar),Y=z(b.unfinishDepre),k=z(g.labor),u=z(g.fohFix),m=z(g.fohVar),C=z(g.unfinishDepre),F=z(b.localOH),v=z(b.toolingOH),S=z(b.rawMaterial),M=z(g.localOH),w=z(g.toolingOH),R=z(g.rawMaterial),U=T+B+E+Y,te=k+u+m+C,pe=F+v+S+U,re=M+w+R+te,x=re===0?100:(pe-re)/re*100;return{...b,no:h+1,totalCost:pe,diff:x,localOH:F,toolingOH:v,rawMaterial:S,labor:T,fohFix:B,fohVar:E,unfinishDepre:Y,localOHPrev:M,toolingOHPrev:w,rawMaterialPrev:R,laborPrev:k,fohFixPrev:u,fohVarPrev:m,unfinishDeprePrev:C,fgCostPrev:z(g.fgCost),mfgCostPrev:z(g.mfgCost),sellingPricePrev:z(g.sellingPrice),totalCostPrev:re,totalProcessCost:U,totalProcessCostPrev:te,exclusiveInvestment:z(b.exclusiveInvestment),exclusiveInvestmentPrev:z(g.exclusiveInvestment)}});r(f),s(o),l(y)},setRows:r}},nr=({selectedMonth:t,setSelectedMonth:r,selectedMonth2:a,setSelectedMonth2:s,handleCompare:i,comparedMonth1:l,comparedMonth2:n,exchangeRates:o})=>{const y=be(),d={"Aug-25":[],"Jul-25":[],"Jun-25":[]};return e.jsx("div",{children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:16},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("button",{className:"btn",onClick:()=>y(-1),style:{backgroundColor:"#007bff",color:"white",border:"none",padding:"8px 12px",fontSize:14,cursor:"pointer",borderRadius:6},children:"← Back"}),e.jsx("h1",{style:{margin:0},children:"Period-over-Period Comparison"})]}),e.jsx("p",{style:{margin:"6px 0 0",color:"#6b7280",fontSize:14},children:"Select two periods to compare the cost differences."})]}),e.jsxs("div",{style:{display:"flex",gap:16,alignItems:"flex-start"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[e.jsxs("select",{value:t,onChange:c=>r(c.target.value),style:{padding:"6px 10px",borderRadius:8,border:"1px solid rgba(0,0,0,0.12)",width:"180px"},children:[e.jsx("option",{value:"",children:"Select Period 1"}),Object.keys(d).map(c=>e.jsx("option",{value:c,children:c},c))]}),e.jsx("input",{type:"text",value:`USD/IDR: ${o[l]||"N/A"}`,readOnly:!0,style:{padding:"6px 10px",borderRadius:8,border:"1px solid rgba(0,0,0,0.12)",backgroundColor:"#f8f9fa",color:"#495057",width:"180px",boxSizing:"border-box",fontSize:"13px"}})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[e.jsxs("select",{value:a,onChange:c=>s(c.target.value),style:{padding:"6px 10px",borderRadius:8,border:"1px solid rgba(0,0,0,0.12)",width:"180px"},children:[e.jsx("option",{value:"",children:"Select Period 2"}),Object.keys(d).map(c=>e.jsx("option",{value:c,children:c},c))]}),e.jsx("input",{type:"text",value:`USD/IDR: ${o[n]||"N/A"}`,readOnly:!0,style:{padding:"6px 10px",borderRadius:8,border:"1px solid rgba(0,0,0,0.12)",backgroundColor:"#f8f9fa",color:"#495057",width:"180px",boxSizing:"border-box",fontSize:"13px"}})]}),e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"flex-start",paddingTop:0},children:[e.jsx("button",{onClick:()=>i(t,a),disabled:!t||!a,className:"btn btn-primary",children:"Compare"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>alert("Export CSV (preview)"),children:"Export"})]})]})]})})},dr=({currentRecords:t,getDiffStyle:r,handleDetailClick:a,getRemarkValue:s,handleRemarkSave:i,comparedMonth1:l,comparedMonth2:n})=>t.length===0?e.jsx("div",{style:{textAlign:"center",padding:"40px 20px",border:"1px dashed #d1d5db",borderRadius:8,backgroundColor:"#f9fafb",marginTop:20},children:e.jsx("p",{style:{fontSize:14,color:"#6b7280"},children:'Please select two periods and click "Compare" to see the results.'})}):e.jsx("div",{style:{overflow:"auto",border:"1px solid rgba(0,0,0,0.06)",borderRadius:8},children:e.jsxs("table",{style:{borderCollapse:"collapse",minWidth:1440,width:"100%"},children:[e.jsxs("thead",{style:{border:"2px solid #059669"},children:[e.jsxs("tr",{style:{border:"1px solid #059669"},children:[e.jsx("th",{rowSpan:"2",style:{...de("#cccccc"),...H,border:"1px solid #059669"},children:"No."}),e.jsx("th",{rowSpan:"2",style:{...de("#cccccc"),...H,border:"1px solid #059669"},children:"PartNo."}),e.jsx("th",{rowSpan:"2",style:{...de("#cccccc"),...H,border:"1px solid #059669"},children:"PartName"}),e.jsx("th",{colSpan:"3",style:{...de("#dff7e6"),border:"1px solid #059669"},children:"Purchase Part"}),e.jsx("th",{colSpan:"3",style:{...de("#b9faf8"),border:"1px solid #059669"},children:"Raw Material"}),e.jsx("th",{colSpan:"12",style:{...de("#e0aaff"),border:"1px solid #059669"},children:"Processing Cost"}),e.jsx("th",{rowSpan:"2",style:{...de("#e0aaff"),...H,border:"1px solid #059669"},children:"Total Process Cost"}),e.jsx("th",{rowSpan:"2",style:{...de("#dff7e6"),...H,border:"1px solid #059669"},children:"Exclusive Investment"}),e.jsx("th",{rowSpan:"2",style:{...de("#dff7e6"),...H,border:"1px solid #059669"},children:`Total Cost (${l||"P1"})`}),e.jsx("th",{rowSpan:"2",style:{...de("#dff7e6"),...H,border:"1px solid #059669"},children:`Total Cost (${n||"P2"})`})]}),e.jsxs("tr",{style:{background:"#dff7e6",border:"1px solid #059669"},children:[e.jsx("th",{style:{...H,backgroundColor:"#d0f0d2",border:"1px solid #059669"},children:l||"Period 1"}),e.jsx("th",{style:{...H,border:"1px solid #059669"},children:"Tooling OH"}),e.jsx("th",{style:{...H,border:"1px solid #059669"},children:"% Diff"}),e.jsx("th",{style:{...H,backgroundColor:"#a6f6f3",border:"1px solid #059669"},children:l||"Period 1"}),e.jsx("th",{style:{...H,backgroundColor:"#b9faf8",border:"1px solid #059669"},children:n||"Period 2"}),e.jsx("th",{style:{...H,backgroundColor:"#b9faf8",border:"1px solid #059669"},children:"% Diff"}),e.jsx("th",{style:{...H,backgroundColor:"#d89cff",border:"1px solid #059669"},children:l||"Period 1"}),e.jsx("th",{style:{...H,backgroundColor:"#e0aaff",border:"1px solid #059669"},children:"Labor"}),e.jsx("th",{style:{...H,backgroundColor:"#e0aaff",border:"1px solid #059669"},children:"% Diff"}),e.jsx("th",{style:{...H,backgroundColor:"#d89cff",border:"1px solid #059669"},children:l||"Period 1"}),e.jsx("th",{style:{...H,backgroundColor:"#e0aaff",border:"1px solid #059669"},children:"FOH Fixed"}),e.jsx("th",{style:{...H,backgroundColor:"#e0aaff",border:"1px solid #059669"},children:"% Diff"}),e.jsx("th",{style:{...H,backgroundColor:"#d89cff",border:"1px solid #059669"},children:l||"Period 1"}),e.jsx("th",{style:{...H,backgroundColor:"#e0aaff",border:"1px solid #059669"},children:"FOH Var"}),e.jsx("th",{style:{...H,backgroundColor:"#e0aaff",border:"1px solid #059669"},children:"% Diff"}),e.jsx("th",{style:{...H,backgroundColor:"#d89cff",border:"1px solid #059669"},children:l||"Period 1"}),e.jsx("th",{style:{...H,backgroundColor:"#e0aaff",border:"1px solid #059669"},children:"Unfinish Depre."}),e.jsx("th",{style:{...H,backgroundColor:"#e0aaff",border:"1px solid #059669"},children:"% Diff"})]})]}),e.jsx("tbody",{children:t.map((o,y)=>{const d=y%2===0;return e.jsxs("tr",{style:{borderBottom:"1px solid rgba(0,0,0,0.04)",backgroundColor:d?"#f9fafb":"white"},children:[e.jsx("td",{style:$,children:o.no}),e.jsx("td",{style:$,children:o.partNo}),e.jsx("td",{style:$,children:o.partName}),e.jsx("td",{style:ge,children:Z(o.toolingOHPrev)}),e.jsx("td",{style:$,children:Z(o.toolingOH)}),e.jsx("td",{style:r(ee(o.toolingOH,o.toolingOHPrev),Oe),children:Se(ee(o.toolingOH,o.toolingOHPrev))}),e.jsx("td",{style:ge,children:Z(o.rawMaterialPrev)}),e.jsx("td",{style:$,children:Z(o.rawMaterial)}),e.jsx("td",{style:r(ee(o.rawMaterial,o.rawMaterialPrev),Oe),children:Se(ee(o.rawMaterial,o.rawMaterialPrev))}),e.jsx("td",{style:ge,children:Z(o.laborPrev)}),e.jsx("td",{style:$,children:Z(o.labor)}),e.jsx("td",{style:r(ee(o.labor,o.laborPrev),Oe),children:Se(ee(o.labor,o.laborPrev))}),e.jsx("td",{style:ge,children:Z(o.fohFixPrev)}),e.jsx("td",{style:$,children:Z(o.fohFix)}),e.jsx("td",{style:r(ee(o.fohFix,o.fohFixPrev),Oe),children:Se(ee(o.fohFix,o.fohFixPrev))}),e.jsx("td",{style:ge,children:Z(o.fohVarPrev)}),e.jsx("td",{style:$,children:Z(o.fohVar)}),e.jsx("td",{style:r(ee(o.fohVar,o.fohVarPrev),Oe),children:Se(ee(o.fohVar,o.fohVarPrev))}),e.jsx("td",{style:ge,children:Z(o.unfinishDeprePrev)}),e.jsx("td",{style:$,children:Z(o.unfinishDepre)}),e.jsx("td",{style:r(ee(o.unfinishDepre,o.unfinishDeprePrev),Oe),children:Se(ee(o.unfinishDepre,o.unfinishDeprePrev))}),e.jsx("td",{style:$,children:Z(o.totalProcessCost)}),e.jsx("td",{style:$,children:Z(o.exclusiveInvestment)}),e.jsx("td",{style:$,children:Z(o.totalCostPrev)}),e.jsx("td",{style:$,children:Z(o.totalCost)})]},o.partNo)})})]})}),de=t=>({background:t,height:18,borderTop:"3px solid rgba(0,0,0,0.08)"}),H={position:"sticky",top:0,zIndex:10,padding:"8px 10px",textAlign:"left",fontSize:12,color:"#0b1220",fontWeight:700,borderBottom:"1px solid rgba(0,0,0,0.06)"},$={padding:"8px 10px",fontSize:13,color:"#111827"},Oe={...$,textAlign:"right"},ge={...$,backgroundColor:"#f5f5f5"};({...ge});const cr={"Aug-25":"15,650","Jul-25":"15,420","Jun-25":"15,890"};function pr(){const{rows:t,comparedMonth1:r,comparedMonth2:a,handleCompare:s}=ir(),[i,l]=p.useState("Jul-25"),[n,o]=p.useState("Aug-25"),[y,d]=p.useState(1),[c,f]=p.useState(10),[b,h]=p.useState(10),[g,T]=p.useState({}),B=Math.ceil(t.length/c),E=y*c,Y=E-c,k=p.useMemo(()=>t.slice(Y,E),[t,Y,E]),u=M=>{d(Math.max(1,Math.min(M,B)))},m=M=>Math.abs(M)>b,C=(M,w)=>g[M]!==void 0?g[M]:w,F=(M,w)=>{T(R=>({...R,[M]:w}))},v=M=>{alert(`Detail view for Part: ${M}`)},S=(M,w)=>M!==null&&m(M)?{...w,color:"red",fontWeight:"bold"}:w;return e.jsx("div",{style:{padding:20},children:e.jsxs("div",{style:{maxWidth:"95vw",margin:"0 auto"},children:[e.jsx(nr,{selectedMonth:i,setSelectedMonth:l,selectedMonth2:n,setSelectedMonth2:o,handleCompare:(M,w)=>{s(M,w),d(1)},comparedMonth1:r,comparedMonth2:a,exchangeRates:cr}),e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("label",{htmlFor:"threshold",style:{fontSize:12},children:"Threshold (%):"}),e.jsx("input",{id:"threshold",type:"number",value:b,onChange:M=>h(Number(M.target.value)),style:{width:60,padding:"4px 8px",fontSize:12,borderRadius:4,border:"1px solid #d1d5db"}})]})}),e.jsx(dr,{currentRecords:k,getDiffStyle:S,handleDetailClick:v,getRemarkValue:C,handleRemarkSave:F,comparedMonth1:r,comparedMonth2:a}),t.length>0&&e.jsx(Qe,{currentPage:y,totalPages:B,goToPage:u,setRecordsPerPage:M=>{f(M),d(1)},recordsPerPage:c,totalRecords:t.length})]})})}const hr=()=>{const t=be(),r=$e(),{partNo:a}=Et(),{part:s,currentPeriod:i,comparisonPeriod:l}=r.state||{},n={current:{toolingOuthouseCost:s?.toolingOuthouseCost||100,laborCost:s?.labor||50,fohFixed:s?.fohFix||30,fohVariable:s?.fohVar||20,unfinishedDepreciation:s?.unfinishDepre||10,exclusiveInvestment:s?.exclusiveInvestment||5},comparison:{toolingOuthouseCost:s?.toolingOuthouseCostPrev||90,laborCost:s?.laborPrev||55,fohFixed:s?.fohFixPrev||32,fohVariable:s?.fohVarPrev||18,unfinishedDepreciation:s?.unfinishDeprePrev||12,exclusiveInvestment:s?.exclusiveInvestmentPrev||4}},o=d=>d==null||d===""?"-":typeof d=="number"?d.toLocaleString(void 0,{minimumFractionDigits:3,maximumFractionDigits:3}):d,y=(d,c)=>d==null||c==null?"-":o(d-c);return e.jsx("div",{style:{padding:20},children:e.jsxs("div",{style:{maxWidth:"95vw",margin:"0 auto"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16,marginBottom:24},children:[e.jsx("button",{onClick:()=>t(-1),style:{backgroundColor:"#007bff",color:"white",border:"none",padding:"8px 12px",fontSize:14,cursor:"pointer",borderRadius:6},children:"← Back"}),e.jsx("h1",{style:{margin:0},children:"Cost Movement Detail"})]}),e.jsxs("div",{style:{display:"flex",gap:16,marginBottom:24,alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontSize:12,color:"#6b7280"},children:"Part No"}),e.jsx("input",{type:"text",value:a,readOnly:!0,style:{width:"200px",padding:"8px",border:"1px solid #ccc",borderRadius:"4px",background:"#f8f9fa"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontSize:12,color:"#6b7280"},children:"Current Period"}),e.jsx("select",{value:i,style:{width:"200px",padding:"8px",border:"1px solid #ccc",borderRadius:"4px"},children:e.jsx("option",{value:i,children:i})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontSize:12,color:"#6b7280"},children:"Comparison Period"}),e.jsx("select",{value:l,style:{width:"200px",padding:"8px",border:"1px solid #ccc",borderRadius:"4px"},children:e.jsx("option",{value:l,children:l})})]})]}),e.jsx("h2",{children:"Cost Breakdown"}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f2f2f2"},children:[e.jsx("th",{style:{padding:"12px 8px",border:"1px solid #ddd",textAlign:"left",fontSize:14},children:"Cost Component"}),e.jsxs("th",{style:{padding:"12px 8px",border:"1px solid #ddd",textAlign:"right",fontSize:14},children:["Current Period (",i,")"]}),e.jsxs("th",{style:{padding:"12px 8px",border:"1px solid #ddd",textAlign:"right",fontSize:14},children:["Comparison Period (",l,")"]}),e.jsx("th",{style:{padding:"12px 8px",border:"1px solid #ddd",textAlign:"right",fontSize:14},children:"Difference"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"8px",border:"1px solid #ddd"},children:"Tooling Outhouse Cost"}),e.jsx("td",{style:{padding:"8px",border:"1px solid #ddd",textAlign:"right"},children:o(n.current.toolingOuthouseCost)}),e.jsx("td",{style:{padding:"8px",border:"1px solid #ddd",textAlign:"right"},children:o(n.comparison.toolingOuthouseCost)}),e.jsx("td",{style:{padding:"8px",border:"1px solid #ddd",textAlign:"right"},children:y(n.current.toolingOuthouseCost,n.comparison.toolingOuthouseCost)})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"8px",border:"1px solid #ddd",fontWeight:"bold"},children:"Processing Cost"}),e.jsx("td",{style:{padding:"8px",border:"1px solid #ddd"}}),e.jsx("td",{style:{padding:"8px",border:"1px solid #ddd"}}),e.jsx("td",{style:{padding:"8px",border:"1px solid #ddd"}})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"8px 8px 8px 32px",border:"1px solid #ddd"},children:"Labor Cost"}),e.jsx("td",{style:{padding:"8px",border:"1px solid #ddd",textAlign:"right"},children:o(n.current.laborCost)}),e.jsx("td",{style:{padding:"8px",border:"1px solid #ddd",textAlign:"right"},children:o(n.comparison.laborCost)}),e.jsx("td",{style:{padding:"8px",border:"1px solid #ddd",textAlign:"right"},children:y(n.current.laborCost,n.comparison.laborCost)})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"8px 8px 8px 32px",border:"1px solid #ddd"},children:"FOH Fixed"}),e.jsx("td",{style:{padding:"8px",border:"1px solid #ddd",textAlign:"right"},children:o(n.current.fohFixed)}),e.jsx("td",{style:{padding:"8px",border:"1px solid #ddd",textAlign:"right"},children:o(n.comparison.fohFixed)}),e.jsx("td",{style:{padding:"8px",border:"1px solid #ddd",textAlign:"right"},children:y(n.current.fohFixed,n.comparison.fohFixed)})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"8px 8px 8px 32px",border:"1px solid #ddd"},children:"FOH Variable"}),e.jsx("td",{style:{padding:"8px",border:"1px solid #ddd",textAlign:"right"},children:o(n.current.fohVariable)}),e.jsx("td",{style:{padding:"8px",border:"1px solid #ddd",textAlign:"right"},children:o(n.comparison.fohVariable)}),e.jsx("td",{style:{padding:"8px",border:"1px solid #ddd",textAlign:"right"},children:y(n.current.fohVariable,n.comparison.fohVariable)})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"8px 8px 8px 32px",border:"1px solid #ddd"},children:"Unfinished Depreciation"}),e.jsx("td",{style:{padding:"8px",border:"1px solid #ddd",textAlign:"right"},children:o(n.current.unfinishedDepreciation)}),e.jsx("td",{style:{padding:"8px",border:"1px solid #ddd",textAlign:"right"},children:o(n.comparison.unfinishedDepreciation)}),e.jsx("td",{style:{padding:"8px",border:"1px solid #ddd",textAlign:"right"},children:y(n.current.unfinishedDepreciation,n.comparison.unfinishedDepreciation)})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"8px",border:"1px solid #ddd"},children:"Exclusive Investment"}),e.jsx("td",{style:{padding:"8px",border:"1px solid #ddd",textAlign:"right"},children:o(n.current.exclusiveInvestment)}),e.jsx("td",{style:{padding:"8px",border:"1px solid #ddd",textAlign:"right"},children:o(n.comparison.exclusiveInvestment)}),e.jsx("td",{style:{padding:"8px",border:"1px solid #ddd",textAlign:"right"},children:y(n.current.exclusiveInvestment,n.comparison.exclusiveInvestment)})]})]})]})]})})},xr=({onDownload:t,selectedPeriod:r,comparisonPeriod:a,availablePeriods:s,onPeriodChange:i,onComparisonPeriodChange:l})=>e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",alignItems:"center",marginBottom:16},children:e.jsx("div",{style:{display:"flex",alignItems:"center"},children:e.jsx("h1",{style:{fontSize:24,fontWeight:"bold",color:"#1F2937"},children:"Casting Material Report"})})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("div",{style:{display:"flex",gap:16,alignItems:"center"},children:s&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"comparison-period-select",style:{fontSize:12,marginRight:8},children:"Compare with"}),e.jsx("select",{id:"comparison-period-select",value:a,onChange:n=>l(n.target.value),style:{padding:"8px",borderRadius:4,border:"1px solid #d1d5db",fontSize:12},children:s.map(n=>e.jsx("option",{value:n,children:n},n))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"period-select",style:{fontSize:12,marginRight:8},children:"Select period"}),e.jsx("select",{id:"period-select",value:r,onChange:n=>i(n.target.value),style:{padding:"8px",borderRadius:4,border:"1px solid #d1d5db",fontSize:12},children:s.map(n=>e.jsx("option",{value:n,children:n},n))})]})]})}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{style:{padding:"8px 16px",borderRadius:4,border:"1px solid #d1d5db",backgroundColor:"#4CAF50",color:"white",fontSize:12,cursor:"pointer"},children:"Submit"}),e.jsxs("button",{onClick:t,style:{display:"flex",alignItems:"center",padding:"8px 16px",borderRadius:4,border:"1px solid #d1d5db",backgroundColor:"#2196F3",color:"white",fontSize:12,cursor:"pointer"},children:["Download",e.jsx("img",{src:xt,alt:"Download",style:{marginLeft:8,height:16}})]})]})]})]}),ur=()=>{const[t,r]=p.useState([]),[a,s]=p.useState([]),[i,l]=p.useState(!0),[n,o]=p.useState(null),[y,d]=p.useState(1),c=20,[f,b]=p.useState({isOpen:!1,column:null,values:[]}),[h,g]=p.useState({}),[T,B]=p.useState("Oct'24-Mar'25"),[E,Y]=p.useState("Apr-Sep'25"),k=p.useMemo(()=>{if(t.length<2)return[];const x=t[1];return Object.keys(x).filter(O=>Array.isArray(x[O]))},[t]),u=async()=>{const x=new ht.Workbook,O=x.addWorksheet("Casting Material"),L=I=>{if(I==null||String(I).trim()==="-")return null;const W=Number(String(I).replace(/\./g,"").replace(",","."));return isNaN(W)?I:W},ae=t.slice(1).filter(I=>Object.entries(h).every(([W,Q])=>{if(!Q||Q.length===0)return!0;const Ve=S(I[W]);return Q.includes(Ve)}));O.addRow(["No","EG Model","Category","Casting Part","CC","Material No","Material Name","Material Category",T,null,null,E,null,null,"Diff Amount","Diff %","Material Price Impact","Gentani Impact","Remark"]),O.addRow([null,null,null,null,null,null,null,null,"Price","Gentani","Total","Price","Gentani","Total",null,null,null,null,null]),O.mergeCells("A1:A2"),O.mergeCells("B1:B2"),O.mergeCells("C1:C2"),O.mergeCells("D1:D2"),O.mergeCells("E1:E2"),O.mergeCells("F1:F2"),O.mergeCells("G1:G2"),O.mergeCells("H1:H2"),O.mergeCells("I1:K1"),O.mergeCells("L1:N1"),O.mergeCells("O1:O2"),O.mergeCells("P1:P2"),O.mergeCells("Q1:Q2"),O.mergeCells("R1:R2"),O.mergeCells("S1:S2"),O.getCell("I2").value="Price",O.getCell("J2").value="Gentani",O.getCell("K2").value="Total",O.getCell("L2").value="Price",O.getCell("M2").value="Gentani",O.getCell("N2").value="Total",["A1","B1","C1","D1","E1","F1","G1","H1","I1","L1","O1","P1","Q1","R1","S1","I2","J2","K2","L2","M2","N2"].forEach(I=>{const W=O.getCell(I);W.font={bold:!0},W.alignment={vertical:"middle",horizontal:"center"},W.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFa8d8f1"}},W.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),["O1","P1","Q1","R1"].forEach(I=>{O.getCell(I).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFbe5014"}},O.getCell(I).font={bold:!0,color:{argb:"FFFFFFFF"}}}),O.getCell("S1").fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFbbfebb"}},["I2","J2","K2","L2","M2","N2"].forEach(I=>{O.getCell(I).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFe3f6ff"}}}),ae.forEach((I,W)=>{O.addRow([W+1,S(I["EG Model"]),S(I.Category),S(I["Casting Part"]),S(I.CC),S(I["Material No"]),S(I["Material Name"]),S(I["Material Category"]),L(I[T]?.[0]),L(I[T]?.[1]),L(I[T]?.[2]),L(I[E]?.[0]),L(I[E]?.[1]),L(I[E]?.[2]),L(I["Diff Amount"]),S(I["Diff %"]),S(I["Material Price Impact"]),S(I["Gentani Impact"]),S(I.Remark)])}),O.columns=[{key:"no",width:5},{key:"eg_model",width:15},{key:"category",width:15},{key:"casting_part",width:20},{key:"cc",width:10},{key:"material_no",width:15},{key:"material_name",width:30},{key:"material_category",width:20},{key:"oct_price",width:15},{key:"oct_gentani",width:15},{key:"oct_total",width:15},{key:"apr_price",width:15},{key:"apr_gentani",width:15},{key:"apr_total",width:15},{key:"diff_amount",width:15},{key:"diff_percent",width:10},{key:"material_price_impact",width:20},{key:"gentani_impact",width:20},{key:"remark",width:20}];const q=await x.xlsx.writeBuffer(),A=new Blob([q],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),N=window.URL.createObjectURL(A),D=document.createElement("a");D.href=N,D.download="casting-material.xlsx",D.click(),window.URL.revokeObjectURL(N)};p.useEffect(()=>{fetch("/finance-dashboard/Casting Material.json").then(O=>{if(!O.ok)throw new Error("Network response was not ok");return O.json()}).then(O=>{r(O),l(!1)}).catch(O=>{o(O),l(!1)})},[]);const m=x=>{if(t.length<2)return[];const O={...h};delete O[x];const ae=t.slice(1).filter(A=>Object.entries(O).every(([N,D])=>{if(D.length===0)return!0;const I=S(A[N]);return D.map(Q=>Q==="(blank)"?"":Q).includes(I)}));return[...new Set(ae.map(A=>S(A[x])))].map(A=>A===""?"(blank)":A)},C=x=>{b({isOpen:!0,column:x,values:m(x)})},F=()=>{b({isOpen:!1,column:null,values:[]})},v=(x,O)=>{g(L=>({...L,[x]:O})),F()};p.useEffect(()=>{if(t.length<2){s(t);return}const O=t.slice(1).filter(L=>Object.entries(h).every(([ae,q])=>{if(q.length===0)return!0;const A=S(L[ae]),N=q.includes("(blank)")&&A==="",D=q.includes(A);return N||D}));s([t[0],...O])},[h,t]);const S=x=>x==null||x===0?"":String(x).trim(),M=x=>{if(x==null||String(x).trim()==="-")return String(x).trim();const O=Number(String(x).replace(/\./g,"").replace(",","."));return isNaN(O)?x:String(x).includes(",")?O.toLocaleString("de-DE",{minimumFractionDigits:3,maximumFractionDigits:3}):O.toLocaleString("de-DE")};if(i)return e.jsx("div",{className:"p-4",children:"Loading..."});if(n)return e.jsxs("div",{className:"p-4",children:["Error loading data: ",n.message]});if(t.length===0)return e.jsx("div",{className:"p-4",children:"No data available."});const w=a.slice(1),R=y*c,U=R-c,te=w.slice(U,R),pe=Math.ceil(w.length/c),re=x=>{x>0&&x<=pe&&d(x)};return e.jsxs("div",{style:{background:"#fff",padding:"16px",position:"relative",display:"flex",flexDirection:"column",height:"calc(100vh - 32px)"},children:[e.jsx(Dt,{to:"/",className:"btn",style:{position:"absolute",top:"16px",right:"16px",textDecoration:"none",color:"#000",fontSize:"16px",fontWeight:"bold",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%"},children:"X"}),e.jsx(xr,{onDownload:u,selectedPeriod:E,comparisonPeriod:T,availablePeriods:k,onPeriodChange:Y,onComparisonPeriodChange:B}),e.jsx("div",{style:{marginTop:"16px"}}),e.jsx("div",{style:{overflow:"auto",flex:"1 1 auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[e.jsxs("thead",{style:{position:"sticky",top:0,zIndex:10},children:[e.jsxs("tr",{style:{borderBottom:"1px solid #d1d5db"},children:[e.jsx("th",{rowSpan:"2",className:"tbl-header",children:"No"}),e.jsxs("th",{rowSpan:"2",className:"tbl-header",style:{background:"#a8d8f1",position:"relative"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer"},onClick:()=>C("EG Model"),children:["EG Model ",e.jsx(oe,{filled:h["EG Model"]?.length>0})]}),f.isOpen&&f.column==="EG Model"&&e.jsx(ie,{title:"EG Model",values:f.values,initialCheckedValues:h["EG Model"]||f.values,onApply:x=>v("EG Model",x),onClose:()=>b({isOpen:!1,column:null,values:[]})})]}),e.jsxs("th",{rowSpan:"2",className:"tbl-header",style:{background:"#a8d8f1",position:"relative"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer"},onClick:()=>C("Category"),children:["Category ",e.jsx(oe,{filled:h.Category?.length>0})]}),f.isOpen&&f.column==="Category"&&e.jsx(ie,{title:"Category",values:f.values,initialCheckedValues:h.Category||f.values,onApply:x=>v("Category",x),onClose:()=>b({isOpen:!1,column:null,values:[]})})]}),e.jsxs("th",{rowSpan:"2",className:"tbl-header",style:{background:"#a8d8f1",position:"relative"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer"},onClick:()=>C("Casting Part"),children:["Casting Part ",e.jsx(oe,{filled:h["Casting Part"]?.length>0})]}),f.isOpen&&f.column==="Casting Part"&&e.jsx(ie,{title:"Casting Part",values:f.values,initialCheckedValues:h["Casting Part"]||f.values,onApply:x=>v("Casting Part",x),onClose:()=>b({isOpen:!1,column:null,values:[]})})]}),e.jsxs("th",{rowSpan:"2",className:"tbl-header",style:{background:"#a8d8f1",position:"relative"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer"},onClick:()=>C("CC"),children:["CC ",e.jsx(oe,{filled:h.CC?.length>0})]}),f.isOpen&&f.column==="CC"&&e.jsx(ie,{title:"CC",values:f.values,initialCheckedValues:h.CC||f.values,onApply:x=>v("CC",x),onClose:()=>b({isOpen:!1,column:null,values:[]})})]}),e.jsxs("th",{rowSpan:"2",className:"tbl-header",style:{background:"#a8d8f1",position:"relative"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer"},onClick:()=>C("Material No"),children:["Material No ",e.jsx(oe,{filled:h["Material No"]?.length>0})]}),f.isOpen&&f.column==="Material No"&&e.jsx(ie,{title:"Material No",values:f.values,initialCheckedValues:h["Material No"]||f.values,onApply:x=>v("Material No",x),onClose:()=>b({isOpen:!1,column:null,values:[]})})]}),e.jsxs("th",{rowSpan:"2",className:"tbl-header",style:{background:"#a8d8f1",position:"relative"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer"},onClick:()=>C("Material Name"),children:["Material Name ",e.jsx(oe,{filled:h["Material Name"]?.length>0})]}),f.isOpen&&f.column==="Material Name"&&e.jsx(ie,{title:"Material Name",values:f.values,initialCheckedValues:h["Material Name"]||f.values,onApply:x=>v("Material Name",x),onClose:()=>b({isOpen:!1,column:null,values:[]})})]}),e.jsxs("th",{rowSpan:"2",className:"tbl-header",style:{background:"#a8d8f1",position:"relative"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer"},onClick:()=>C("Material Category"),children:["Material Category ",e.jsx(oe,{filled:h["Material Category"]?.length>0})]}),f.isOpen&&f.column==="Material Category"&&e.jsx(ie,{title:"Material Category",values:f.values,initialCheckedValues:h["Material Category"]||f.values,onApply:x=>v("Material Category",x),onClose:()=>b({isOpen:!1,column:null,values:[]})})]}),e.jsx("th",{colSpan:"3",className:"tbl-header",style:{background:"#a8d8f1"},children:T}),e.jsx("th",{colSpan:"3",className:"tbl-header",style:{background:"#a8d8f1"},children:E}),e.jsx("th",{rowSpan:"2",className:"tbl-header",style:{background:"#be5014",color:"white"},children:"Diff Amount"}),e.jsx("th",{rowSpan:"2",className:"tbl-header",style:{background:"#be5014",color:"white"},children:"Diff %"}),e.jsx("th",{rowSpan:"2",className:"tbl-header",style:{background:"#be5014",color:"white"},children:"Material Price Impact"}),e.jsx("th",{rowSpan:"2",className:"tbl-header",style:{background:"#be5014",color:"white"},children:"Gentani Impact"}),e.jsx("th",{rowSpan:"2",className:"tbl-header",style:{background:"#bbfebb"},children:"Remark"})]}),e.jsxs("tr",{style:{borderBottom:"1px solid #d1d5db"},children:[e.jsx("th",{className:"tbl-header",style:{background:"#e3f6ff"},children:"Price"}),e.jsx("th",{className:"tbl-header",style:{background:"#e3f6ff"},children:"Gentani"}),e.jsx("th",{className:"tbl-header",style:{background:"#e3f6ff"},children:"Total"}),e.jsx("th",{className:"tbl-header",style:{background:"#e3f6ff"},children:"Price"}),e.jsx("th",{className:"tbl-header",style:{background:"#e3f6ff"},children:"Gentani"}),e.jsx("th",{className:"tbl-header",style:{background:"#e3f6ff"},children:"Total"})]})]}),e.jsx("tbody",{children:te.map((x,O)=>{const L=S(x.Remark),ae=L==="New Material"?{backgroundColor:"#eaf5e9"}:{},q=L==="delete material"?{backgroundColor:"#eaf5e9"}:{},A=L==="Increasing gentani"?{backgroundColor:"#eaf5e9"}:{},N={border:"1px solid #e5e7eb",textAlign:"left"},D={...N,textAlign:"right"},I={...N,textAlign:"center"};return e.jsxs("tr",{style:{...ae,borderBottom:"1px solid #e5e7eb"},children:[e.jsx("td",{className:"td-default",style:I,children:U+O+1}),e.jsx("td",{className:"td-default",style:N,children:S(x["EG Model"])}),e.jsx("td",{className:"td-default",style:N,children:S(x.Category)}),e.jsx("td",{className:"td-default",style:{...N,backgroundColor:"#eaf5e9"},children:S(x["Casting Part"])}),e.jsx("td",{className:"td-default",style:{...N,backgroundColor:"#eaf5e9"},children:S(x.CC)}),e.jsx("td",{className:"td-default",style:N,children:S(x["Material No"])}),e.jsx("td",{className:"td-default",style:N,children:S(x["Material Name"])}),e.jsx("td",{className:"td-default",style:N,children:S(x["Material Category"])}),e.jsx("td",{className:"td-default",style:D,children:M(x[T]?.[0])}),e.jsx("td",{className:"td-default",style:D,children:M(x[T]?.[1])}),e.jsx("td",{className:"td-default",style:D,children:M(x[T]?.[2])}),e.jsx("td",{className:"td-default",style:D,children:M(x[E]?.[0])}),e.jsx("td",{className:"td-default",style:D,children:M(x[E]?.[1])}),e.jsx("td",{className:"td-default",style:D,children:M(x[E]?.[2])}),e.jsx("td",{className:"td-default",style:{...D,...q},children:M(x["Diff Amount"])}),e.jsx("td",{className:"td-default",style:D,children:S(x["Diff %"])}),e.jsx("td",{className:"td-default",style:N,children:S(x["Material Price Impact"])}),e.jsx("td",{className:"td-default",style:{...N,...A},children:S(x["Gentani Impact"])}),e.jsx("td",{className:"td-default",style:N,children:L})]},U+O)})})]})}),e.jsx(Qe,{currentPage:y,totalPages:pe,goToPage:re,totalRecords:w.length,startIndex:U,endIndex:R})]})},fr=()=>{const[t,r]=p.useState(""),[a,s]=p.useState(""),i=be(),n=$e().state?.from?.pathname||"/",o=y=>{y.preventDefault();let d=null;t==="admin"&&a==="1"?d={username:"admin",role:"admin"}:t==="komo"&&a==="1"&&(d={username:"komo",role:"DpH"}),d?(localStorage.setItem("isAuthenticated","true"),localStorage.setItem("user",JSON.stringify(d)),d.role==="DpH"?i("/ppr",{replace:!0}):i(n,{replace:!0})):alert("Invalid credentials")};return e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:e.jsxs("form",{onSubmit:o,style:{display:"flex",flexDirection:"column",gap:"10px",padding:"20px",border:"1px solid #ccc",borderRadius:"5px"},children:[e.jsx("h2",{children:"Login"}),e.jsx("input",{type:"text",placeholder:"Username",value:t,onChange:y=>r(y.target.value),style:{padding:"8px"}}),e.jsx("input",{type:"password",placeholder:"Password",value:a,onChange:y=>s(y.target.value),style:{padding:"8px"}}),e.jsx("button",{type:"submit",style:{padding:"10px",cursor:"pointer"},children:"Login"})]})})},me=({children:t})=>{const r=localStorage.getItem("isAuthenticated"),a=$e();return r?t:e.jsx(Ft,{to:"/login",state:{from:a},replace:!0})},mr="/finance-dashboard/";It.createRoot(document.getElementById("root")).render(e.jsx(Mt.StrictMode,{children:e.jsx(Bt,{basename:mr,children:e.jsxs(wt,{children:[e.jsx(ue,{path:"/login",element:e.jsx(fr,{})}),e.jsx(ue,{path:"/",element:e.jsx(me,{children:e.jsx(Lt,{})})}),e.jsx(ue,{path:"/sync",element:e.jsx(me,{children:e.jsx(Kt,{})})}),e.jsx(ue,{path:"/ppr",element:e.jsx(me,{children:e.jsx(rr,{})})}),e.jsx(ue,{path:"/part-pairing",element:e.jsx(me,{children:e.jsx(or,{})})}),e.jsx(ue,{path:"/period-comparison",element:e.jsx(me,{children:e.jsx(pr,{})})}),e.jsx(ue,{path:"/cost-movement-detail/:partNo",element:e.jsx(me,{children:e.jsx(hr,{})})}),e.jsx(ue,{path:"/casting-material",element:e.jsx(me,{children:e.jsx(ur,{})})})]})})}));
